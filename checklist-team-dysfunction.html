<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Dysfunction Checklist | The Employee Playbook</title>

    <!-- ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.png">
    <link rel="icon" type="image/png" href="assets/img/favicon.png">

    <style>
        /* ===========================
           ROOT VARIABLES (From Homepage)
        =========================== */
        :root {
            --primary-white: #FFFFFF;
            --light-gray: #F8F9FA;
            --medium-gray: #E9ECEF;
            --dark-gray: #6C757D;
            --text-dark: #212529;
            --text-medium: #495057;
            --accent-purple: #7B5FC4;
            --accent-purple-dark: #5A4496;
            --light-purple: #E6E0F5;
            --lighter-purple: #F0EBFA;
            --border-light: rgba(0, 0, 0, 0.08);
            --hero-gray: #f5f7fa;
            --nav-bg: rgba(255, 255, 255, 0.95);
            --hero-bg: linear-gradient(135deg, #F9F6FF 0%, #F0EBFA 100%);
            --premium-gradient: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
            
            /* UPDATED Category Colors from your reference */
            --category-clarity: #7B5FC4;
            --category-burnout: #f59e0b;
            --category-manager: #10b981;
            --category-politics: #3b82f6;
            --category-hr: #6D28D9;
            --category-confidence: #ef4444;
            --category-career: #800020;
        }

        /* Dark Mode Variables */
        .dark-mode {
            --primary-white: #1a1a1a;
            --light-gray: #2a2a2a;
            --medium-gray: #3a3a3a;
            --dark-gray: #888888;
            --text-dark: #e0e0e0;
            --text-medium: #b0b0b0;
            --accent-purple: #9d86e9;
            --accent-purple-dark: #7b5fc4;
            --light-purple: rgba(123, 95, 196, 0.2);
            --lighter-purple: rgba(123, 95, 196, 0.1);
            --border-light: rgba(255, 255, 255, 0.08);
            --hero-gray: #2a2a2a;
            --nav-bg: rgba(30, 30, 30, 0.95);
            --hero-bg: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
            --premium-gradient: linear-gradient(135deg, #9d86e9 0%, #7b5fc4 100%);
            
            /* UPDATED Category Colors - Dark Mode */
            --category-clarity: #9d86e9;
            --category-burnout: #fbbf24;
            --category-manager: #34d399;
            --category-politics: #60a5fa;
            --category-hr: #8B5CF6;
            --category-confidence: #f87171;
            --category-career: #B03060;
        }

        /* ===========================
           GLOBAL STYLES
        =========================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        body {
            background-color: var(--primary-white);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            opacity: 0;
            transition: opacity 0.4s ease;
            min-height: 100vh;
        }

        body.loaded { opacity: 1; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ===========================
           NAVIGATION
        =========================== */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-light);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, border-color 0.3s ease;
            height: 80px;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            height: 100%;
        }

        .logo-img {
            height: 100px;
            width: auto;
            transform: translateX(20%);
            padding: 14px 10px;
            transition: all 0.3s ease;
            display: block;
            min-height: 100px;
        }

        .logo-img.fallback {
            width: 200px;
            height: 50px;
            background: var(--accent-purple);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            border-radius: 4px;
            transform: translateX(20%);
        }

        .nav-links {
            display: flex;
            gap: 50px;
        }

        .nav-link {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            font-size: 17px;
        }

        .nav-link:hover {
            color: var(--accent-purple);
        }

        .nav-link-container {
            position: relative;
            display: inline-block;
        }

        .new-tag {
            position: absolute;
            top: -12px;
            right: -35px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #000;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
            white-space: nowrap;
        }

        .dark-mode .new-tag {
            box-shadow: 0 2px 4px rgba(0,0,0,0.4);
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 24px;
            transform: translateX(-20%);
        }

        .header-cta {
            background: var(--accent-purple);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(123, 95, 196, 0.3);
        }

        .header-cta:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(123, 95, 196, 0.35);
        }

        .dark-mode .header-cta {
            box-shadow: 0 5px 15px rgba(123, 95, 196, 0.5);
        }

        .sign-in {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            font-size: 17px;
        }

        .sign-in:hover {
            color: var(--accent-purple);
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 16px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .theme-toggle:hover {
            background-color: var(--light-gray);
        }

        .mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .mobile-toggle:hover {
            background-color: var(--light-gray);
        }

        .mobile-sign-in,
        .mobile-sign-up {
            display: none;
        }

        @media (max-width: 768px) {
            .nav-container {
                justify-content: center;
                position: relative;
            }

            .logo {
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                align-items: center;
                height: 100%;
            }

            .logo-img {
                height: 125px;
                transform: none;
                padding: 12px 0;
            }

            .mobile-toggle {
                display: flex;
                position: absolute;
                left: 20px;
                align-items: center;
            }

            .nav-actions {
                transform: none;
                gap: 16px;
                position: absolute;
                right: 20px;
                align-items: center;
            }

            .nav-actions .sign-in,
            .nav-actions .header-cta {
                display: none;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--nav-bg);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                flex-direction: column;
                padding: 20px;
                border-top: 1px solid var(--border-light);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                gap: 20px;
            }

            .nav-links.active {
                display: flex;
            }

            .nav-link-container {
                display: flex;
                align-items: center;
                justify-content: flex-start;
                width: 100%;
            }

            .new-tag {
                position: static;
                margin-left: 8px;
            }

            .mobile-sign-in {
                display: block !important;
                margin-top: 10px;
                padding: 12px 20px;
                background: var(--primary-white);
                color: var(--accent-purple);
                border-radius: 8px;
                text-align: center;
                font-weight: 600;
                text-decoration: none;
                border: 2px solid var(--accent-purple);
                transition: all 0.3s ease;
            }

            .mobile-sign-in:hover {
                background: var(--light-gray);
                transform: translateY(-2px);
            }

            .mobile-sign-up {
                display: block !important;
                margin-top: 10px;
                padding: 12px 20px;
                background: var(--accent-purple);
                color: white;
                border-radius: 8px;
                text-align: center;
                font-weight: 600;
                text-decoration: none;
                border: 2px solid var(--accent-purple);
                transition: all 0.3s ease;
            }

            .mobile-sign-up:hover {
                background: var(--accent-purple-dark);
                transform: translateY(-2px);
            }
        }

        /* ===========================
           ENHANCED HERO SECTION
        =========================== */
        .tool-hero-section {
            width: 100%;
            background: var(--hero-bg);
            padding: 20px 0 30px;
            margin-top: 110px;
            position: relative;
            border-bottom: 1px solid var(--border-light);
            overflow: hidden;
        }

        .tool-hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(135deg, rgba(250, 245, 255, 0.85) 0%, rgba(245, 240, 255, 0.6) 50%, rgba(255, 255, 255, 0.25) 100%);
            z-index: 1;
        }

        .dark-mode .tool-hero-section::before {
            background: linear-gradient(135deg, rgba(42, 42, 42, 0.9) 0%, rgba(31, 31, 31, 0.7) 50%, rgba(26, 26, 26, 0.4) 100%);
        }

        .tool-hero-section::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.06), transparent);
            opacity: 0.25;
            pointer-events: none;
        }

        .dark-mode .tool-hero-section::after {
            background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent);
        }

        .tool-hero-content {
            position: relative;
            z-index: 2;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px 10px;
            animation: heroFadeUp 0.45s ease-out;
        }

        @keyframes heroFadeUp {
            from {
                opacity: 0;
                transform: translateY(18px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Breadcrumb styling */
        .breadcrumb {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--dark-gray);
            margin-bottom: 10px;
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .breadcrumb a {
            color: var(--text-medium);
            text-decoration: none !important;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: var(--accent-purple-dark);
        }

        .breadcrumb span {
            color: var(--text-medium);
        }

        .breadcrumb i {
            color: var(--dark-gray);
            opacity: 0.8;
        }

        .breadcrumb .current {
            color: var(--text-dark);
            font-weight: 600;
        }

        /* Save Item button in hero (top-right of hero) */
        .save-btn {
            position: absolute;
            top: 16px;
            right: 24px;
            z-index: 5;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
            border-radius: 999px;
            border: 1px solid rgba(123, 95, 196, 0.6);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: var(--accent-purple-dark);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .save-btn i {
            font-size: 13px;
        }

        .save-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(123, 95, 196, 0.18);
            background: #ffffff;
        }

        .dark-mode .save-btn {
            background: rgba(20, 20, 20, 0.9);
            border-color: rgba(157, 134, 233, 0.6);
        }

        .save-btn.saved {
            background: var(--accent-purple);
            color: #ffffff;
            border-color: transparent;
        }

        .save-btn.saved i {
            font-weight: 700;
        }

        .checklist-name {
            font-size: 20px;
            font-weight: 600;
            color: var(--accent-purple);
            text-transform: uppercase;
            letter-spacing: 1.8px;
            margin-bottom: 14px;
            margin-top: 32px;
            display: block;
        }

        .hero-main-heading {
            font-size: 46px;
            font-weight: 600;
            color: var(--text-dark);
            line-height: 1.1;
            margin-bottom: 20px;
            max-width: 720px;
        }

        .hero-subheading {
            font-size: 16px;
            color: var(--text-medium);
            line-height: 1.6;
            max-width: 780px;
            margin-bottom: 30px;
        }

        /* ===========================
           UPDATED CATEGORY PILLS SECTION WITH CORRECT COLORS AND NAMES
        =========================== */
        .category-pills-container {
            margin-bottom: 30px;
        }

        .category-pills-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-medium);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 14px;
            display: block;
        }

        .category-pills-grid {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .category-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid transparent;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            text-decoration: none;
            height: 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
        }

        .dark-mode .category-pill {
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .category-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            text-decoration: none;
        }

        .dark-mode .category-pill:hover {
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.35);
        }

        /* CORRECT Category Pill Colors and Names from your reference */
        .category-pill.clarity {
            color: var(--category-clarity);
            border-color: rgba(123, 95, 196, 0.2);
            background: linear-gradient(135deg, rgba(123, 95, 196, 0.08), rgba(123, 95, 196, 0.04));
        }

        .dark-mode .category-pill.clarity {
            color: var(--category-clarity);
            border-color: rgba(157, 134, 233, 0.3);
            background: linear-gradient(135deg, rgba(123, 95, 196, 0.18), rgba(123, 95, 196, 0.1));
        }

        .category-pill.manager {
            color: var(--category-manager);
            border-color: rgba(16, 185, 129, 0.2);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(16, 185, 129, 0.04));
        }

        .dark-mode .category-pill.manager {
            color: var(--category-manager);
            border-color: rgba(52, 211, 153, 0.3);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.18), rgba(16, 185, 129, 0.1));
        }

        .category-pill.confidence {
            color: var(--category-confidence);
            border-color: rgba(239, 68, 68, 0.2);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(239, 68, 68, 0.04));
        }

        .dark-mode .category-pill.confidence {
            color: var(--category-confidence);
            border-color: rgba(248, 113, 113, 0.3);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.18), rgba(239, 68, 68, 0.1));
        }

        .category-pill.burnout {
            color: var(--category-burnout);
            border-color: rgba(245, 158, 11, 0.2);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(245, 158, 11, 0.04));
        }

        .dark-mode .category-pill.burnout {
            color: var(--category-burnout);
            border-color: rgba(251, 191, 36, 0.3);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.18), rgba(245, 158, 11, 0.1));
        }

        .category-pill.politics {
            color: var(--category-politics);
            border-color: rgba(59, 130, 246, 0.2);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(59, 130, 246, 0.04));
        }

        .dark-mode .category-pill.politics {
            color: var(--category-politics);
            border-color: rgba(96, 165, 250, 0.3);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.18), rgba(59, 130, 246, 0.1));
        }

        .category-pill.hr {
            color: var(--category-hr);
            border-color: rgba(109, 40, 217, 0.2);
            background: linear-gradient(135deg, rgba(109, 40, 217, 0.08), rgba(109, 40, 217, 0.04));
        }

        .dark-mode .category-pill.hr {
            color: var(--category-hr);
            border-color: rgba(139, 92, 246, 0.3);
            background: linear-gradient(135deg, rgba(109, 40, 217, 0.18), rgba(109, 40, 217, 0.1));
        }

        .category-pill.career {
            color: var(--category-career);
            border-color: rgba(128, 0, 32, 0.2);
            background: linear-gradient(135deg, rgba(128, 0, 32, 0.08), rgba(128, 0, 32, 0.04));
        }

        .dark-mode .category-pill.career {
            color: var(--category-career);
            border-color: rgba(176, 48, 96, 0.3);
            background: linear-gradient(135deg, rgba(128, 0, 32, 0.18), rgba(128, 0, 32, 0.1));
        }

        .category-icon {
            font-size: 11px;
            opacity: 0.8;
            flex-shrink: 0;
        }

        /* ===========================
           CONTEXT & PRO TIPS SECTION
        =========================== */
        .context-tips-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 40px;
            width: 100%;
            max-width: 1100px;
            margin: 0 auto 50px;
            padding: 24px 20px 10px;
            margin-top: 6px;
        }

        .context-card, .tips-card {
            background: var(--primary-white);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 28px 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .dark-mode .context-card,
        .dark-mode .tips-card {
            box-shadow: 0 2px 8px rgba(0,0,0,0.22);
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }

        .section-title i {
            color: var(--accent-purple);
        }

        .bullet-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .bullet-list li {
            color: var(--text-medium);
            line-height: 1.6;
            margin-bottom: 14px;
            padding-left: 26px;
            position: relative;
        }

        .bullet-list li::before {
            content: "•";
            position: absolute;
            left: 10px;
            color: var(--accent-purple);
            font-size: 18px;
        }

        /* ===========================
           CHECKLIST BODY
        =========================== */
        .checklist-body {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px 20px;
        }

        .checklist-section-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-purple-dark);
            margin-bottom: 18px;
            margin-top: 60px !important;
        }

        .checklist-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .checklist-item {
            background: var(--primary-white);
            padding: 14px 16px;
            border-radius: 10px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
            border: 1px solid var(--border-light);
            display: flex;
            gap: 12px;
            align-items: flex-start;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            height: 100%;
            min-height: 70px;
        }

        .dark-mode .checklist-item {
            box-shadow: 0 1px 4px rgba(0,0,0,0.14);
        }

        .checklist-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        .dark-mode .checklist-item:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.28);
        }

        .checklist-item i {
            color: var(--accent-purple);
            font-size: 18px;
            margin-top: 3px;
            flex-shrink: 0;
        }

        .checklist-text {
            flex: 1;
            color: var(--text-medium);
            font-size: 15px;
            line-height: 1.5;
        }

        /* ===========================
           TEAM HEALTH SCORE BAR
        =========================== */
        .clarity-score-section {
            max-width: 1100px;
            margin: 25px auto 40px;
            padding: 0 20px;
        }

        .presence-snapshot-header {
            margin-bottom: 18px;
            text-align: left;
        }

        .presence-snapshot-header h2 {
            font-size: 22px;
            font-weight: 700;
            color: var(--accent-purple-dark);
            margin-bottom: 6px;
        }

        .presence-snapshot-header p {
            font-size: 14px;
            color: var(--text-medium);
            max-width: 1100px;
            line-height: 1.5;
        }

        .clarity-score-bar {
            display: flex;
            align-items: stretch;
            gap: 30px;
            background: var(--primary-white);
            border-radius: 16px;
            padding: 22px 24px 20px;
            box-shadow: 0 8px 30px rgba(123, 95, 196, 0.12);
            border: 1px solid rgba(123, 95, 196, 0.15);
        }

        .dark-mode .clarity-score-bar {
            box-shadow: 0 8px 30px rgba(123, 95, 196, 0.25);
            border: 1px solid rgba(123, 95, 196, 0.35);
        }

        .clarity-progress-container {
            flex: 1.4;
        }

        .clarity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .clarity-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-purple-dark);
        }

        .clarity-percentage {
            font-size: 28px;
            font-weight: 800;
            color: var(--accent-purple);
        }

        .progress-container {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .dark-mode .progress-container {
            background: rgba(255, 255, 255, 0.12);
        }

        .progress-fill {
            height: 100%;
            background: var(--premium-gradient);
            width: 0%;
            border-radius: 5px;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--dark-gray);
        }

        .presence-dimensions {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
            margin-top: 14px;
        }

        .presence-dimension-pill {
            border-radius: 10px;
            padding: 8px 10px;
            border: 1px solid var(--border-light);
            background: var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: var(--text-medium);
        }

        .dark-mode .presence-dimension-pill {
            background: rgba(255,255,255,0.04);
            border-color: rgba(255,255,255,0.1);
        }

        .presence-dimension-pill span.label {
            font-weight: 600;
            color: var(--text-dark);
        }

        .presence-dimension-pill span.score {
            font-weight: 700;
            color: var(--accent-purple);
        }

        .actions-container {
            display: flex;
            gap: 12px;
            flex-shrink: 0;
            flex-direction: column;
            justify-content: center;
            align-items: stretch;
            max-width: 260px;
        }

        .action-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            padding: 10px 18px;
            font-size: 13.5px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            width: 100%;
            justify-content: center;
        }

        .action-btn i {
            font-size: 14px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.3);
        }

        .dark-mode .action-btn:hover {
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.4);
        }

        .action-btn.secondary {
            background: var(--light-purple);
            color: var(--accent-purple-dark);
        }

        .dark-mode .action-btn.secondary {
            background: rgba(123, 95, 196, 0.21);
            color: var(--accent-purple);
        }

        .action-btn.secondary:hover {
            background: var(--accent-purple);
            color: white;
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .progress-fill.high {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .progress-fill.medium {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .progress-fill.low {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        /* ===========================
           COMPACT SMART SUMMARY SECTION
        =========================== */
        .smart-summary-section {
            max-width: 1100px;
            margin: 0 auto 60px;
            padding: 0 20px;
            display: none;
        }

        .smart-summary-section.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .summary-header {
            text-align: center;
            margin-bottom: 28px;
        }

        .summary-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-purple-dark);
            margin-bottom: 6px;
        }

        .summary-subtitle {
            color: var(--text-medium);
            font-size: 16px;
            margin-bottom: 8px;
        }

        .summary-insight {
            font-size: 14px;
            color: var(--dark-gray);
            max-width: 680px;
            margin: 0 auto;
        }

        /* Section Headers */
        .section-header {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
        }

        .section-header.red {
            color: #ef4444;
        }

        .section-header.purple {
            color: var(--accent-purple-dark);
        }

        .section-header.blue {
            color: var(--accent-purple);
        }

        /* Red Flags Grid - 3 in a row */
        .red-flags-grid,
        .next-steps-grid,
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .red-flag-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.08);
            border: 1px solid rgba(239, 68, 68, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .dark-mode .red-flag-card {
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.18);
            border: 1px solid rgba(239, 68, 68, 0.22);
        }

        .red-flag-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .flag-icon {
            font-size: 20px;
            color: #ef4444;
            margin-bottom: 15px;
            width: 40px;
            height: 40px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode .flag-icon {
            background: rgba(239, 68, 68, 0.2);
        }

        .flag-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .flag-description {
            color: var(--text-medium);
            font-size: 14px;
            line-height: 1.5;
            flex-grow: 1;
        }

        /* Next Steps Grid - 3 in a row */
        .next-step-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.08);
            border: 1px solid rgba(123, 95, 196, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .dark-mode .next-step-card {
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.21);
            border: 1px solid rgba(123, 95, 196, 0.25);
        }

        .next-step-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
        }

        .step-icon {
            font-size: 20px;
            color: var(--accent-purple);
            margin-bottom: 15px;
            width: 40px;
            height: 40px;
            background: var(--lighter-purple);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode .step-icon {
            background: rgba(123, 95, 196, 0.21);
        }

        .step-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .step-description {
            color: var(--text-medium);
            font-size: 14px;
            line-height: 1.5;
            flex-grow: 1;
        }

        /* Resources Grid - 3 in a row */
        .resource-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.08);
            border: 1px solid rgba(123, 95, 196, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
            transition: all 0.2s ease;
        }

        .dark-mode .resource-card {
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.21);
            border: 1px solid rgba(123, 95, 196, 0.25);
        }

        .resource-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.16);
        }

        .dark-mode .resource-card:hover {
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.25);
        }

        .resource-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
        }

        .resource-icon {
            font-size: 20px;
            color: var(--accent-purple);
            margin-bottom: 15px;
            width: 40px;
            height: 40px;
            background: var(--lighter-purple);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode .resource-icon {
            background: rgba(123, 95, 196, 0.21);
        }

        .resource-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .resource-description {
            color: var(--text-medium);
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .resource-link {
            color: var(--accent-purple);
            font-weight: 600;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: auto;
        }

        .resource-link:hover {
            text-decoration: underline;
        }

        /* ===========================
           MY PLAYBOOK FLOATING BUTTON + SIDEBAR
        =========================== */
        .my-playbook-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1200;
            background: var(--premium-gradient);
            color: #ffffff;
            padding: 10px 16px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
            transition: all 0.25s ease;
        }

        .my-playbook-fab i {
            font-size: 15px;
        }

        .my-playbook-fab:hover {
            transform: translateY(-3px);
            box-shadow: 0 14px 30px rgba(0,0,0,0.32);
        }

        .playbook-sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.45);
            z-index: 1190;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
        }

        .playbook-sidebar-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        .playbook-sidebar {
            position: fixed;
            top: 0;
            right: -380px;
            width: 340px;
            max-width: 90%;
            height: 100%;
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            box-shadow: -4px 0 20px rgba(0,0,0,0.25);
            z-index: 1191;
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--border-light);
            transition: right 0.25s ease;
        }

        .dark-mode .playbook-sidebar {
            background: rgba(18, 18, 18, 0.96);
            box-shadow: -4px 0 22px rgba(0,0,0,0.6);
        }

        .playbook-sidebar.open {
            right: 0;
        }

        .playbook-sidebar-header {
            padding: 20px 20px 14px;
            border-bottom: 1px solid var(--border-light);
        }

        .playbook-sidebar-header-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .playbook-sidebar-header h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-dark);
        }

        .playbook-sidebar-header p {
            font-size: 13px;
            color: var(--dark-gray);
        }

        .playbook-close-btn {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 18px;
            border-radius: 999px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        .playbook-close-btn:hover {
            background: var(--light-gray);
        }

        .playbook-sidebar-body {
            padding: 14px 18px 20px;
            padding-bottom: 50px; /* prevents overlap with floating button */            
            overflow-y: auto;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .saved-items-empty {
            font-size: 13px;
            color: var(--dark-gray);
            line-height: 1.6;
        }

        .saved-items-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .saved-item {
            padding: 10px 8px 10px;
            border-radius: 10px;
            border: 1px solid var(--border-light);
            background: var(--primary-white);
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .saved-item-title-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 6px;
        }

        .saved-item-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .saved-item-type {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            color: var(--accent-purple-dark);
        }

        .saved-item-meta {
            font-size: 12px;
            color: var(--dark-gray);
        }

        .saved-item-link {
            margin-top: 6px;
            font-size: 12px;
            color: var(--accent-purple);
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .saved-item-link:hover {
            text-decoration: underline;
        }

        /* ===========================
        QUICK LINKS — CLEAN VERSION
        =========================== */
        .playbook-quick-links {
            margin-top: 223px;               /* move the whole section lower */
            padding-top: 10px;
            border-top: 1px solid var(--border-light);
        }

        .playbook-quick-links-header {
            margin-bottom: 4px;
        }

        .quick-links-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-medium);
        }

        .playbook-quick-links-list {
            display: flex;
            flex-direction: column;         /* stack vertically */
            gap: 10px;                      /* spacing between pills */
            margin-top: 6px;                /* subtle space under the heading */
        }

        /* --- Quick Link Pill --- */
        .quick-link-pill {
            width: 50%;                     /* narrower pill width */
            padding: 4px 4px;
            border-radius: 999px;
            border: 1px solid rgba(123, 95, 196, 0.35);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.08),rgba(123, 95, 196, 0.02));
            text-decoration: none;
            color: var(--accent-purple-dark);
            font-size: 13px;
            font-weight: 500;
           
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-link-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.12);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.16), rgba(123, 95, 196, 0.06));
        }

        .quick-link-pill i {
            font-size: 14px;
        }

        .dark-mode .quick-link-pill {
            border-color: rgba(157, 134, 233, 0.55);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.26),rgba(123, 95, 196, 0.12));
        }

        /* ===========================
           FOOTER
        =========================== */
        footer {
            background: var(--primary-white);
            padding: 10px 0;
            border-top: 1px solid var(--border-light);
            margin-top: 30px;
            text-align: center;
            color: var(--text-medium);
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .context-tips-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .red-flags-grid,
            .next-steps-grid,
            .resources-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .checklist-grid {
                grid-template-columns: 1fr;
            }

            .checklist-section-title {
                margin-top: 50px !important;
            }

            .clarity-score-bar {
                flex-direction: column;
            }

            .actions-container {
                max-width: 100%;
                flex-direction: row;
            }
        }

        @media (max-width: 768px) {
            .tool-hero-section {
                margin-top: 100px;
            }

            .context-tips-grid {
                padding: 20px 20px 10px;
                margin-top: 5px;
            }

            .context-card, .tips-card {
                padding: 24px;
            }

            .section-title {
                font-size: 18px;
                white-space: normal;
            }

            .hero-main-heading {
                font-size: 36px;
            }

            .hero-subheading {
                font-size: 16px;
                max-width: 100%;
            }

            .clarity-score-bar {
                padding: 18px 18px 18px;
            }

            .actions-container {
                flex-direction: column;
                align-items: stretch;
            }

            .red-flags-grid,
            .next-steps-grid,
            .resources-grid {
                grid-template-columns: 1fr;
            }

            .category-pills-grid {
                justify-content: flex-start;
            }

            .checklist-section-title {
                margin-top: 40px !important;
            }

            .save-btn {
                right: 18px;
                top: 10px;
            }

            .my-playbook-fab {
                bottom: 18px;
                right: 18px;
            }
        }

        @media (max-width: 480px) {
            .hero-main-heading {
                font-size: 32px;
            }

            .checklist-name {
                font-size: 18px;
            }

            .summary-title {
                font-size: 22px;
            }

            .section-header {
                font-size: 18px;
            }

            .clarity-percentage {
                font-size: 24px;
            }

            .category-pill {
                font-size: 11px;
                padding: 5px 10px;
                height: 30px;
            }

            .checklist-item {
                padding: 12px 14px;
                min-height: 65px;
            }

            .checklist-text {
                font-size: 14px;
            }

            .checklist-section-title {
                margin-top: 30px !important;
            }

            .presence-dimensions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

<!-- ===========================
     NAVIGATION
=========================== -->
<nav>
    <div class="container nav-container">
        <button class="mobile-toggle"><i class="fas fa-bars"></i></button>

        <a href="index.html" class="logo">
            <img src="./assets/img/logo.png" alt="The Employee Playbook" class="logo-img" id="mainLogo">
        </a>

        <div class="nav-links">
            <a href="the-lens.html" class="nav-link">The Lens</a>
            <a href="the-toolkit.html" class="nav-link">The Toolkit</a>
            <div class="nav-link-container">
                <a href="the-coach.html" class="nav-link">The Coach</a>
                <span class="new-tag">NEW</span>
            </div>
            <a href="the-shift.html" class="nav-link">The Shift</a>
            <a href="the-pricing.html" class="nav-link">The Pricing</a>
            <a href="sign-in.html" class="mobile-sign-in">Sign In</a>
            <a href="create-account.html" class="mobile-sign-up">Sign Up</a>
        </div>

        <div class="nav-actions">
            <a href="create-account.html" class="header-cta">Sign up</a>
            <a href="sign-in.html" class="sign-in">Sign in</a>
            <button class="theme-toggle" id="themeToggleBtn"><i class="fas fa-moon"></i></button>
        </div>
    </div>
</nav>

<!-- ===========================
     ENHANCED HERO SECTION
=========================== -->
<div class="tool-hero-section">
    <!-- Save button anchored to hero -->
    <button class="save-btn" id="saveBtn">
        <i class="far fa-bookmark"></i>
        <span>Save</span>
    </button>

    <div class="tool-hero-content">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <a href="index.html"><i class="fas fa-house"></i> Home</a>
            <i class="fas fa-chevron-right"></i>
            <a href="the-toolkit.html">Toolkit</a>
            <i class="fas fa-chevron-right"></i>
            <a href="category-workplace-dynamics-and-politics.html">
                Workplace Dynamics and Politics
            </a>
            <i class="fas fa-chevron-right"></i>
            <span class="current">Team Dysfunction Checklist</span>
        </div>

        <!-- Checklist name (purple, 20% bigger) -->
        <span class="checklist-name">
            TEAM DYSFUNCTION CHECKLIST
        </span>

        <!-- Main hero heading (black, large) with reduced space above -->
        <h1 class="hero-main-heading">Identify and address common team dysfunctions</h1>

        <!-- Hero subheading -->
        <div class="hero-subheading">
            When collaboration feels strained, trust is low, or progress is stuck, use this checklist to diagnose issues and implement practical fixes that restore team effectiveness.
        </div>

        <!-- Category Pills - UPDATED WITH CORRECT CATEGORIES -->
        <div class="category-pills-container">
            <span class="category-pills-title">Explore Categories</span>

            <div class="category-pills-grid">
                <a href="category-manager-relationship-and-leadership-style.html" class="category-pill manager">
                    <i class="fas fa-people-arrows category-icon"></i>
                    <span>Manager Relationship & Leadership Style</span>
                </a>

                <a href="category-confidence-presence-influence.html" class="category-pill confidence">
                    <i class="fas fa-chart-line category-icon"></i>
                    <span>Confidence, Presence & Influence</span>
                </a>

                <a href="category-expectation-burnout-and-capacity.html" class="category-pill burnout">
                    <i class="fas fa-battery-three-quarters"></i>
                    <span>Expectations, Burnout & Capacity</span>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- ===========================
     CONTEXT & PRO TIPS SECTION
=========================== -->
<div class="context-tips-grid">
    <div class="context-card">
        <h3 class="section-title"><i class="fas fa-calendar-check"></i>When to Use This Checklist</h3>
        <ul class="bullet-list">
            <li>When team meetings feel unproductive or tense</li>
            <li>When collaboration is breaking down or silos are forming</li>
            <li>When trust seems low and political behavior is increasing</li>
            <li>When deadlines are consistently missed despite individual effort</li>
            <li>When you're leading a new team or inheriting an existing one</li>
        </ul>
    </div>

    <div class="tips-card">
        <h3 class="section-title"><i class="fas fa-lightbulb"></i>Pro Tips</h3>
        <ul class="bullet-list">
            <li>Be objective - assess behaviors, not personalities</li>
            <li>Use this as a conversation starter, not a weapon</li>
            <li>Focus on the most critical 2-3 issues first</li>
            <li>Involve the team in creating solutions together</li>
            <li>Revisit quarterly to track progress and identify new issues</li>
        </ul>
    </div>
</div>

<!-- ===========================
     CHECKLIST BODY CONTENT
=========================== -->
<div class="checklist-body" id="checklistText">

    <h2 class="checklist-section-title">Team Health Assessment</h2>

    <div class="checklist-grid">
        <div class="checklist-item" data-category="trust">
            <i class="far fa-square"></i>
            <div class="checklist-text">Team members feel psychologically safe to share ideas, admit mistakes, and ask for help.</div>
        </div>
        <div class="checklist-item" data-category="clarity">
            <i class="far fa-square"></i>
            <div class="checklist-text">Everyone understands team goals, priorities, and their individual roles clearly.</div>
        </div>
        <div class="checklist-item" data-category="conflict">
            <i class="far fa-square"></i>
            <div class="checklist-text">Disagreements are addressed constructively, not avoided or escalated personally.</div>
        </div>
        <div class="checklist-item" data-category="accountability">
            <i class="far fa-square"></i>
            <div class="checklist-text">Team members hold each other accountable for commitments and quality standards.</div>
        </div>
        <div class="checklist-item" data-category="engagement">
            <i class="far fa-square"></i>
            <div class="checklist-text">All team members are actively engaged in meetings and collaborative work.</div>
        </div>
        <div class="checklist-item" data-category="trust">
            <i class="far fa-square"></i>
            <div class="checklist-text">Team members give each other the benefit of the doubt before jumping to negative conclusions.</div>
        </div>
        <div class="checklist-item" data-category="clarity">
            <i class="far fa-square"></i>
            <div class="checklist-text">Decision-making processes are clear, and everyone understands how decisions are made.</div>
        </div>
        <div class="checklist-item" data-category="communication">
            <i class="far fa-square"></i>
            <div class="checklist-text">Communication is open, transparent, and includes all relevant stakeholders.</div>
        </div>
        <div class="checklist-item" data-category="engagement">
            <i class="far fa-square"></i>
            <div class="checklist-text">Team members proactively support each other during workload spikes or challenges.</div>
        </div>
        <div class="checklist-item" data-category="accountability">
            <i class="far fa-square"></i>
            <div class="checklist-text">When commitments are missed, the focus is on problem-solving, not blame.</div>
        </div>
        <div class="checklist-item" data-category="trust">
            <i class="far fa-square"></i>
            <div class="checklist-text">Feedback is given and received regularly in a constructive, non-defensive manner.</div>
        </div>
        <div class="checklist-item" data-category="conflict">
            <i class="far fa-square"></i>
            <div class="checklist-text">Unresolved tensions or interpersonal issues don't linger and poison team dynamics.</div>
        </div>
        <div class="checklist-item" data-category="clarity">
            <i class="far fa-square"></i>
            <div class="checklist-text">Team meetings have clear agendas, stay focused, and result in actionable next steps.</div>
        </div>
        <div class="checklist-item" data-category="communication">
            <i class="far fa-square"></i>
            <div class="checklist-text">Information flows freely across the team without gatekeeping or information hoarding.</div>
        </div>
        <div class="checklist-item" data-category="engagement">
            <i class="far fa-square"></i>
            <div class="checklist-text">Team members celebrate each other's successes and recognize collective achievements.</div>
        </div>
        <div class="checklist-item" data-category="accountability">
            <i class="far fa-square"></i>
            <div class="checklist-text">Performance standards are consistently applied across all team members.</div>
        </div>
    </div>
</div>

<!-- ===========================
     TEAM HEALTH SCORE BAR
=========================== -->
<div class="clarity-score-section">
    <div class="presence-snapshot-header">
        <h2>Your Team Health Snapshot</h2>
        <p>
            Your Team Health Score measures the functional effectiveness of your team. High scores indicate strong collaboration, trust, and accountability. Low or mixed scores highlight specific dysfunctions that, if addressed, can dramatically improve team performance and satisfaction.
        </p>
    </div>

    <div class="clarity-score-bar">
        <div class="clarity-progress-container">
            <div class="clarity-header">
                <div class="clarity-title">Team Health Score</div>
                <div class="clarity-percentage" id="clarityPercentage">0%</div>
            </div>
            <div class="progress-container">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-labels">
                <span>Dysfunctional</span>
                <span>Needs Improvement</span>
                <span>High Performing</span>
            </div>

            <div class="presence-dimensions">
                <div class="presence-dimension-pill">
                    <span class="label">Trust & Psychological Safety</span>
                    <span class="score" id="scorePriorities">0%</span>
                </div>
                <div class="presence-dimension-pill">
                    <span class="label">Clarity & Alignment</span>
                    <span class="score" id="scoreDeadlines">0%</span>
                </div>
                <div class="presence-dimension-pill">
                    <span class="label">Accountability & Standards</span>
                    <span class="score" id="scoreResources">0%</span>
                </div>
                <div class="presence-dimension-pill">
                    <span class="label">Conflict & Communication</span>
                    <span class="score" id="scoreExpectations">0%</span>
                </div>
            </div>
        </div>

        <div class="actions-container">
            <button class="action-btn" onclick="generateSmartSummary()" id="generateBtn" disabled>
                <i class="fas fa-magic"></i> Generate Analysis
            </button>
            <button class="action-btn secondary" onclick="copyChecklist()" id="copyBtn">
                <i class="far fa-copy"></i> Copy Checklist
            </button>
        </div>
    </div>
</div>

<!-- ===========================
     COMPACT SMART SUMMARY SECTION
=========================== -->
<div class="smart-summary-section" id="smartSummary">
    <div class="summary-header">
        <h2 class="summary-title">Your Team Dysfunction Analysis</h2>
        <p class="summary-subtitle">Based on your Team Health Score of <span id="summaryScore">0%</span></p>
        <p class="summary-insight">
            Team dysfunctions are often interconnected. Addressing one area frequently improves others. Focus on the highest-impact issues first.
        </p>
    </div>

    <h3 class="section-header red">
        <i class="fas fa-exclamation-triangle"></i> Critical Dysfunctions Identified
    </h3>
    <div class="red-flags-grid" id="redFlagsGrid">
        <!-- Red flags will be generated here -->
    </div>

    <h3 class="section-header purple">
        <i class="fas fa-forward"></i> Repair Strategies
    </h3>
    <div class="next-steps-grid" id="nextStepsGrid">
        <!-- Next steps will be generated here -->
    </div>

    <h3 class="section-header blue">
        <i class="fas fa-tools"></i> Team Repair Resources
    </h3>
    <div class="resources-grid" id="resourcesGrid">
        <!-- Resources will be generated here -->
    </div>
</div>

<!-- ===========================
     MY PLAYBOOK SIDEBAR
=========================== -->
<div class="playbook-sidebar-overlay" id="playbookOverlay">
    <div class="playbook-sidebar" id="playbookSidebar">
        <div class="playbook-sidebar-header">
            <div class="playbook-sidebar-header-title-row">
                <h3>My Playbook</h3>
                <button class="playbook-close-btn" id="closePlaybook" aria-label="Close My Playbook">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p>Saved items</p>
        </div>
        <div class="playbook-sidebar-body">
            <div id="savedItemsContainer">
                <p class="saved-items-empty" id="savedItemsEmpty">
                    You haven't saved anything yet. Use <strong>Save item</strong> on tools you want quick access to.
                </p>
                <ul class="saved-items-list" id="savedItemsList"></ul>
            </div>

            <!-- Quick links at bottom -->
            <div class="playbook-quick-links">
                <div class="playbook-quick-links-header">
                    <span class="quick-links-title">Quick links</span>
                </div>
                <div class="playbook-quick-links-list">
                    <a href="my-playbook.html" class="quick-link-pill">
                        <i class="fas fa-gauge"></i> The Dashboard
                    </a>                    
                    <a href="the-lens.html" class="quick-link-pill">
                        <i class="fas fa-search"></i> The Lens
                    </a>
                    <a href="the-toolkit.html" class="quick-link-pill">
                        <i class="fas fa-toolbox"></i> The Toolkit
                    </a>
                    <a href="the-coach.html" class="quick-link-pill">
                        <i class="fas fa-comments"></i> The Coach
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Floating My Playbook button -->
<div class="my-playbook-fab" id="myPlaybookButton">
    <i class="fas fa-book-open"></i>
    <span>My Playbook</span>
</div>

<!-- ===========================
     FOOTER
=========================== -->
<footer>
    <div class="container">
        <p>© 2025 The Employee Playbook. All rights reserved.</p>
    </div>
</footer>

<!-- ===========================
     JAVASCRIPT
=========================== -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM fully loaded and parsed');
    
    document.body.classList.add('loaded');
    
    // Initialize checklist functionality
    initializeChecklist();
    
    // Initialize theme toggle
    initializeThemeToggle();
    
    // Mobile navigation toggle
    initializeMobileNav();
    
    // Initialize My Playbook functionality
    initializePlaybook();
});

/* ===========================
   MOBILE NAV
=========================== */
function initializeMobileNav() {
    const mobileToggle = document.querySelector('.mobile-toggle');
    const navLinks = document.querySelector('.nav-links');
    
    if (mobileToggle) {
        mobileToggle.addEventListener('click', function () {
            navLinks.classList.toggle('active');
            const icon = this.querySelector('i');
            if (icon) {
                icon.classList.toggle('fa-bars');
                icon.classList.toggle('fa-times');
            }
        });
    } else {
        console.error('Mobile toggle button not found');
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
        if (navLinks.classList.contains('active') && 
            !navLinks.contains(event.target) && 
            !mobileToggle.contains(event.target)) {
            navLinks.classList.remove('active');
            if (mobileToggle) {
                const icon = mobileToggle.querySelector('i');
                if (icon) {
                    icon.classList.add('fa-bars');
                    icon.classList.remove('fa-times');
                }
            }
        }
    });
}

/* ===========================
   THEME TOGGLE
=========================== */
function initializeThemeToggle() {
    const themeToggleBtn = document.getElementById('themeToggleBtn');
    if (!themeToggleBtn) {
        console.error('Theme toggle button not found');
        return;
    }
    
    const themeIcon = themeToggleBtn.querySelector('i');
    const logoImg = document.getElementById('mainLogo');
    
    console.log('Logo element:', logoImg);
    
    // Function to get correct file path
    function getLogoPath(filename) {
        // Check if we're running from file system
        if (window.location.protocol === 'file:') {
            // For file:// protocol, we need to calculate the path
            const currentPath = window.location.pathname;
            const basePath = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
            return basePath + 'assets/img/' + filename;
        } else {
            // For http:// or https:// protocol, use relative path
            return './assets/img/' + filename;
        }
    }
    
    // Function to create fallback logo
    function createFallbackLogo(isDarkMode) {
        if (!logoImg) return;
        
        logoImg.classList.add('fallback');
        if (isDarkMode) {
            logoImg.style.background = 'var(--accent-purple)';
            logoImg.style.color = 'white';
        } else {
            logoImg.style.background = 'var(--accent-purple)';
            logoImg.style.color = 'white';
        }
        
        // Create text fallback
        const logoText = document.createElement('div');
        logoText.textContent = 'THE EMPLOYEE PLAYBOOK';
        logoText.style.fontSize = '14px';
        logoText.style.fontWeight = '700';
        logoText.style.letterSpacing = '1px';
        
        // Clear image and add text
        logoImg.src = '';
        logoImg.alt = 'The Employee Playbook';
        logoImg.style.display = 'flex';
        logoImg.style.alignItems = 'center';
        logoImg.style.justifyContent = 'center';
        logoImg.innerHTML = '';
        logoImg.appendChild(logoText);
    }
    
    // Function to update logo based on theme
    function updateLogoForTheme(isDarkMode) {
        if (!logoImg) {
            console.error('Logo image element not found');
            return;
        }
        
        // Remove fallback class if it exists
        logoImg.classList.remove('fallback');
        
        if (isDarkMode) {
            // Try dark logo
            const darkLogoPath = getLogoPath('logo-dark.png');
            console.log('Attempting to load dark logo from:', darkLogoPath);
            logoImg.src = darkLogoPath;
        } else {
            // Use light logo
            const lightLogoPath = getLogoPath('logo.png');
            console.log('Loading light logo from:', lightLogoPath);
            logoImg.src = lightLogoPath;
        }
        
        // Restore alt text
        logoImg.alt = 'The Employee Playbook';
    }
    
    // Check for saved theme or prefer-color-scheme
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    const savedTheme = localStorage.getItem('theme');
    
    // Initialize theme based on saved preference or system
    if (savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches)) {
        document.body.classList.add('dark-mode');
        if (themeIcon) {
            themeIcon.classList.remove('fa-moon');
            themeIcon.classList.add('fa-sun');
        }
        updateLogoForTheme(true);
    } else {
        // Ensure light mode is set properly
        document.body.classList.remove('dark-mode');
        if (themeIcon) {
            themeIcon.classList.remove('fa-sun');
            themeIcon.classList.add('fa-moon');
        }
        updateLogoForTheme(false);
    }
    
    themeToggleBtn.addEventListener('click', function() {
        const isDarkMode = document.body.classList.contains('dark-mode');
        
        if (isDarkMode) {
            // Switching to light mode
            document.body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light');
            if (themeIcon) {
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            }
            updateLogoForTheme(false);
        } else {
            // Switching to dark mode
            document.body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark');
            if (themeIcon) {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            }
            updateLogoForTheme(true);
        }
    });
    
    // Listen for system theme changes
    prefersDarkScheme.addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
            if (e.matches) {
                document.body.classList.add('dark-mode');
                if (themeIcon) {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                }
                updateLogoForTheme(true);
            } else {
                document.body.classList.remove('dark-mode');
                if (themeIcon) {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                }
                updateLogoForTheme(false);
            }
        }
    });
    
    // Handle logo loading errors (fallback to text logo)
    if (logoImg) {
        logoImg.addEventListener('error', function() {
            console.error('Logo failed to load:', this.src);
            
            // Check current theme for fallback
            const isDarkMode = document.body.classList.contains('dark-mode');
            
            // If this is dark logo failing, try light logo first
            if (this.src.includes('logo-dark.png')) {
                console.warn('Dark logo not found, trying light logo...');
                const lightLogoPath = getLogoPath('logo.png');
                this.src = lightLogoPath;
                // If light logo also fails, it will trigger another error event
            } else {
                // Both logos failed, use fallback
                console.warn('Both logos failed, using fallback text logo');
                createFallbackLogo(isDarkMode);
            }
        });
        
        logoImg.addEventListener('load', function() {
            console.log('Logo loaded successfully:', this.src);
            // Ensure fallback class is removed
            this.classList.remove('fallback');
        });
    }
}

/* ===========================
   CHECKLIST LOGIC
=========================== */
let checkedItems = [];
let itemCategories = [];

const dimensionConfig = {
    trust: ['trust'],
    clarity: ['clarity'],
    accountability: ['accountability'],
    communication: ['communication', 'conflict', 'engagement']
};

function initializeChecklist() {
    const checklistContainers = document.querySelectorAll('.checklist-item');
    checkedItems = new Array(checklistContainers.length).fill(false);
    itemCategories = [];

    checklistContainers.forEach((container, index) => {
        const icon = container.querySelector('i');
        const category = container.getAttribute('data-category');
        itemCategories[index] = category;

        container.addEventListener('click', function(e) {
            if (e.target.tagName === 'BUTTON') return;

            if (icon.classList.contains('fa-square')) {
                icon.classList.remove('fa-square');
                icon.classList.add('fa-check-square');
                icon.style.color = '#5A4496';
                checkedItems[index] = true;
            } else {
                icon.classList.remove('fa-check-square');
                icon.classList.add('fa-square');
                icon.style.color = '#7B5FC4';
                checkedItems[index] = false;
            }
            
            updateTeamHealthScore();
        });
    });
    
    // Initialize checkedItems array
    checkedItems = new Array(checklistContainers.length).fill(false);
}

function updateTeamHealthScore() {
    const checkedCount = checkedItems.filter(Boolean).length;
    const totalCount = checkedItems.length;
    const teamHealthScore = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;
    
    // Update percentage and progress bar
    document.getElementById('clarityPercentage').textContent = teamHealthScore + '%';
    const progressFill = document.getElementById('progressFill');
    progressFill.style.width = teamHealthScore + '%';
    
    // Update progress bar color based on score
    progressFill.classList.remove('high', 'medium', 'low');
    if (teamHealthScore >= 75) {
        progressFill.classList.add('high');
    } else if (teamHealthScore >= 40) {
        progressFill.classList.add('medium');
    } else {
        progressFill.classList.add('low');
    }
    
    // Enable/disable generate button
    document.getElementById('generateBtn').disabled = checkedCount === 0;
    
    // Calculate dimension scores
    const dimensionScores = {
        trust: { checked: 0, total: 0 },
        clarity: { checked: 0, total: 0 },
        accountability: { checked: 0, total: 0 },
        communication: { checked: 0, total: 0 }
    };
    
    itemCategories.forEach((category, index) => {
        Object.keys(dimensionConfig).forEach(dim => {
            if (dimensionConfig[dim].includes(category)) {
                dimensionScores[dim].total += 1;
                if (checkedItems[index]) {
                    dimensionScores[dim].checked += 1;
                }
            }
        });
    });
    
    const trustScore = dimensionScores.trust.total 
        ? Math.round((dimensionScores.trust.checked / dimensionScores.trust.total) * 100) 
        : 0;
    const clarityScore = dimensionScores.clarity.total 
        ? Math.round((dimensionScores.clarity.checked / dimensionScores.clarity.total) * 100) 
        : 0;
    const accountabilityScore = dimensionScores.accountability.total 
        ? Math.round((dimensionScores.accountability.checked / dimensionScores.accountability.total) * 100) 
        : 0;
    const communicationScore = dimensionScores.communication.total 
        ? Math.round((dimensionScores.communication.checked / dimensionScores.communication.total) * 100) 
        : 0;
    
    document.getElementById('scorePriorities').textContent = trustScore + '%';
    document.getElementById('scoreDeadlines').textContent = clarityScore + '%';
    document.getElementById('scoreResources').textContent = accountabilityScore + '%';
    document.getElementById('scoreExpectations').textContent = communicationScore + '%';
}

/* ===========================
   SMART SUMMARY
=========================== */
function generateSmartSummary() {
    const checkedCount = checkedItems.filter(Boolean).length;
    const totalCount = checkedItems.length;
    const teamHealthScore = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;
    
    // Update summary score
    document.getElementById('summaryScore').textContent = teamHealthScore + '%';
    
    // Show the summary section
    document.getElementById('smartSummary').classList.add('active');
    
    // Scroll to summary
    document.getElementById('smartSummary').scrollIntoView({ behavior: 'smooth' });
    
    // Generate red flags based on unchecked items
    generateRedFlags();
    
    // Generate next steps based on team health score
    generateNextSteps(teamHealthScore);
    
    // Generate recommended resources based on weak areas
    generateRecommendedResources();
}

function generateRedFlags() {
    const redFlagsGrid = document.getElementById('redFlagsGrid');
    redFlagsGrid.innerHTML = '';
    
    // Define red flags based on unchecked items
    const redFlags = [];
    
    // Check for specific category issues
    const uncheckedCategories = {};
    checkedItems.forEach((checked, index) => {
        if (!checked) {
            const category = itemCategories[index];
            uncheckedCategories[category] = (uncheckedCategories[category] || 0) + 1;
        }
    });
    
    // Trust issues
    if (uncheckedCategories['trust']) {
        redFlags.push({
            title: 'Low Psychological Safety',
            description: 'Team members don\'t feel safe to take risks, admit mistakes, or challenge ideas openly.',
            icon: 'fas fa-shield-alt'
        });
    }
    
    // Clarity issues
    if (uncheckedCategories['clarity']) {
        redFlags.push({
            title: 'Role & Goal Ambiguity',
            description: 'Unclear goals, roles, or decision-making processes create confusion and duplication.',
            icon: 'fas fa-bullseye'
        });
    }
    
    // Accountability issues
    if (uncheckedCategories['accountability']) {
        redFlags.push({
            title: 'Weak Accountability',
            description: 'Missed commitments, uneven standards, or blame culture instead of problem-solving.',
            icon: 'fas fa-balance-scale'
        });
    }
    
    // Conflict issues
    if (uncheckedCategories['conflict']) {
        redFlags.push({
            title: 'Unresolved Conflict',
            description: 'Tension, avoidance, or personal attacks instead of constructive disagreement.',
            icon: 'fas fa-users-slash'
        });
    }
    
    // Engagement issues
    if (uncheckedCategories['engagement']) {
        redFlags.push({
            title: 'Disengagement',
            description: 'Team members are checked out, not supporting each other, or celebrating wins.',
            icon: 'fas fa-heart-broken'
        });
    }
    
    // Communication issues
    if (uncheckedCategories['communication']) {
        redFlags.push({
            title: 'Poor Communication',
            description: 'Information hoarding, unclear messaging, or exclusion of key stakeholders.',
            icon: 'fas fa-comment-slash'
        });
    }
    
    // If we have multiple unchecked items but no specific category matches
    const uncheckedCount = checkedItems.filter(item => !item).length;
    if (uncheckedCount >= 6 && redFlags.length === 0) {
        redFlags.push({
            title: 'Multiple Dysfunctions',
            description: 'Several interconnected issues are undermining team effectiveness.',
            icon: 'fas fa-exclamation-triangle'
        });
    }
    
    // If no red flags (high health)
    if (redFlags.length === 0) {
        redFlags.push({
            title: 'Healthy Team Dynamics',
            description: 'Excellent! Your team demonstrates strong trust, clarity, and collaboration.',
            icon: 'fas fa-check-circle'
        });
    }
    
    // Ensure we have at least 3 red flags (duplicate if necessary)
    while (redFlags.length < 3) {
        if (redFlags.length === 1) {
            redFlags.push({
                title: 'Meeting Inefficiency',
                description: 'Meetings lack focus, clear agendas, or result in actionable outcomes.',
                icon: 'fas fa-clock'
            });
        } else {
            redFlags.push({
                title: 'Lack of Recognition',
                description: 'Team successes and individual contributions are not celebrated or acknowledged.',
                icon: 'fas fa-trophy'
            });
        }
    }
    
    // Generate red flag cards (max 3)
    redFlags.slice(0, 3).forEach((flag, index) => {
        const card = document.createElement('div');
        card.className = 'red-flag-card';
        card.innerHTML = `
            <div class="flag-icon">
                <i class="${flag.icon}"></i>
            </div>
            <h4 class="flag-title">${flag.title}</h4>
            <p class="flag-description">${flag.description}</p>
        `;
        redFlagsGrid.appendChild(card);
    });
}

function generateNextSteps(teamHealthScore) {
    const nextStepsGrid = document.getElementById('nextStepsGrid');
    nextStepsGrid.innerHTML = '';
    
    let steps = [];
    
    if (teamHealthScore >= 75) {
        steps = [
            {
                title: 'Maintain & Strengthen',
                description: 'Continue regular team health checks and celebrate what\'s working well.',
                icon: 'fas fa-heart'
            },
            {
                title: 'Peer Recognition Program',
                description: 'Implement structured peer recognition to reinforce positive behaviors.',
                icon: 'fas fa-award'
            },
            {
                title: 'Cross-Team Collaboration',
                description: 'Leverage your team\'s health to improve collaboration with other teams.',
                icon: 'fas fa-hands-helping'
            }
        ];
    } else if (teamHealthScore >= 40) {
        steps = [
            {
                title: 'Team Retrospective',
                description: 'Facilitate an honest conversation about what\'s working and what needs improvement.',
                icon: 'fas fa-comments'
            },
            {
                title: 'Clarity Reset',
                description: 'Revisit team goals, roles, and decision-making processes together.',
                icon: 'fas fa-bullhorn'
            },
            {
                title: 'Trust Building',
                description: 'Implement regular check-ins and vulnerability exercises to build psychological safety.',
                icon: 'fas fa-handshake'
            }
        ];
    } else {
        steps = [
            {
                title: 'Urgent Intervention',
                description: 'Schedule offsite or facilitated session to address critical dysfunctions.',
                icon: 'fas fa-exclamation-circle'
            },
            {
                title: 'Psychological Safety First',
                description: 'Focus on creating safety before addressing performance or accountability issues.',
                icon: 'fas fa-shield-alt'
            },
            {
                title: 'External Facilitation',
                description: 'Consider bringing in an external facilitator for difficult conversations.',
                icon: 'fas fa-user-friends'
            }
        ];
    }
    
    // Generate step cards WITHOUT numbers
    steps.forEach((step, index) => {
        const card = document.createElement('div');
        card.className = 'next-step-card';
        card.innerHTML = `
            <div class="step-icon">
                <i class="${step.icon}"></i>
            </div>
            <h4 class="step-title">${step.title}</h4>
            <p class="step-description">${step.description}</p>
        `;
        nextStepsGrid.appendChild(card);
    });
}

function generateRecommendedResources() {
    const resourcesGrid = document.getElementById('resourcesGrid');
    resourcesGrid.innerHTML = '';
    
    // Analyze which areas need help
    const uncheckedCategories = {};
    
    checkedItems.forEach((checked, index) => {
        if (!checked) {
            const category = itemCategories[index];
            uncheckedCategories[category] = (uncheckedCategories[category] || 0) + 1;
        }
    });
    
    // Determine resources based on weak areas
    let resources = [];
    
    // Always include team health resource
    resources.push({
        title: 'Psychological Safety Checklist',
        description: 'Anonymous survey to assess psychological safety, clarity, and accountability.',
        icon: 'fas fa-poll',
        link: '#'
    });
    
    // Trust resources if needed
    if (uncheckedCategories['trust']) {
        resources.push({
            title: 'Trust Building Framework',
            description: 'Simple, repeatable trust moves that reduce defensiveness and increase candour.',
            icon: 'fas fa-shield-alt',
            link: '#'
        });
    } else {
        resources.push({
            title: 'Pattern Recognition Checklist',
            description: 'Run a clean debrief: spot what keeps repeating, what triggered it, and the one change that breaks the loop next time.',
            icon: 'fas fa-sync-alt',
            link: '#'
        });
    }
    
    // Conflict resources if needed
    if (uncheckedCategories['conflict']) {
        resources.push({
            title: 'Conflict Resolution Framework',
            description: 'Turn disagreement into progress. Sstructure the conversation so it stays factual and productive.',
            icon: 'fas fa-users',
            link: '#'
        });
    } else {
        resources.push({
            title: 'Meeting Effectiveness Guide',
            description: 'Make meetings outcome-driven: clear decisions, owners, timelines and fewer “we’ll circle back” loops.',
            icon: 'fas fa-clipboard-list',
            link: '#'
        });
    }
    
    // If we still need more resources, add defaults
    if (resources.length < 3) {
        resources.push({
            title: 'Expectation Alignment Checklist',
            description: 'Lock commitments into reality: what “done” means, who owns it, and how you’ll track it.',
            icon: 'fas fa-tasks',
            link: '#'
        });
    }
    
    if (resources.length < 3) {
        resources.push({
            title: 'Role Clarity and Scope Checklist',
            description: 'Define scope, decision rights, and boundaries — so gaps and overlaps stop quietly wrecking delivery.',
            icon: 'fas fa-user-tag',
            link: '#'
        });
    }
    
    // Generate resource cards (max 3)
    resources.slice(0, 3).forEach(resource => {
        const card = document.createElement('div');
        card.className = 'resource-card';
        card.innerHTML = `
            <div class="resource-icon">
                <i class="${resource.icon}"></i>
            </div>
            <h4 class="resource-title">${resource.title}</h4>
            <p class="resource-description">${resource.description}</p>
            <a href="${resource.link}" class="resource-link">
                Access Resource <i class="fas fa-arrow-right"></i>
            </a>
        `;
        resourcesGrid.appendChild(card);
    });
}

/* ===========================
   COPY CHECKLIST
=========================== */
function copyChecklist() {
    // Get all text content
    const checklistName = 'TEAM DYSFUNCTION CHECKLIST';
    const mainHeading = document.querySelector('.hero-main-heading').textContent;
    const checklistItems = document.querySelectorAll('.checklist-text');
    
    let text = `${checklistName}\n`;
    text += `=============================\n\n`;
    text += `${mainHeading}\n\n`;
    
    text += `CHECKLIST ITEMS:\n`;
    text += `================\n\n`;
    
    checklistItems.forEach((item, index) => {
        const isChecked = checkedItems[index] ? '[✓]' : '[ ]';
        text += `${isChecked} ${index + 1}. ${item.innerText}\n`;
    });
    
    // Add current stats if available
    const checkedCount = checkedItems.filter(Boolean).length;
    if (checkedCount > 0) {
        const teamHealthScore = Math.round((checkedCount / checklistItems.length) * 100);
        text += `\nCURRENT STATUS:\n`;
        text += `===============\n`;
        text += `Items checked: ${checkedCount}/${checklistItems.length}\n`;
        text += `Team Health Score: ${teamHealthScore}%\n`;
    }
    
    navigator.clipboard.writeText(text);
    
    // Show visual feedback
    const btn = document.getElementById('copyBtn');
    const originalHTML = btn.innerHTML;
    const originalBg = btn.style.background;
    
    btn.innerHTML = '<i class="fas fa-check"></i> Checklist Copied!';
    btn.style.background = '#10b981';
    
    setTimeout(() => {
        btn.innerHTML = originalHTML;
        btn.style.background = originalBg;
    }, 2000);
}

/* ===========================
   MY PLAYBOOK (LOCALSTORAGE)
=========================== */
const PLAYBOOK_KEY = 'tepSavedItems';
const CURRENT_TOOL_ID = 'team-dysfunction-checklist';
const CURRENT_TOOL_TITLE = 'Team Dysfunction Checklist';
const CURRENT_TOOL_TYPE = 'Checklist';

function getSavedItems() {
    try {
        const raw = localStorage.getItem(PLAYBOOK_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
    } catch (e) {
        console.warn('Error reading saved items:', e);
        return [];
    }
}

function setSavedItems(items) {
    try {
        localStorage.setItem(PLAYBOOK_KEY, JSON.stringify(items));
    } catch (e) {
        console.warn('Error saving items:', e);
    }
}

function initializePlaybook() {
    const playbookOverlay = document.getElementById('playbookOverlay');
    const playbookSidebar = document.getElementById('playbookSidebar');
    const playbookButton = document.getElementById('myPlaybookButton');
    const closeBtn = document.getElementById('closePlaybook');
    const saveItemBtn = document.getElementById('saveBtn');

    if (!playbookOverlay || !playbookSidebar || !playbookButton || !closeBtn || !saveItemBtn) return;

    renderSavedItems();

    const savedItems = getSavedItems();
    const isAlreadySaved = savedItems.some(item => item.id === CURRENT_TOOL_ID);
    updateSaveButtonState(saveItemBtn, isAlreadySaved);

    saveItemBtn.addEventListener('click', () => {
        const items = getSavedItems();
        const index = items.findIndex(item => item.id === CURRENT_TOOL_ID);
        let nowSaved;

        if (index === -1) {
            const toolLink = window.location.pathname.split('/').pop() || 'team-dysfunction-checklist.html';
            items.push({
                id: CURRENT_TOOL_ID,
                title: CURRENT_TOOL_TITLE,
                type: CURRENT_TOOL_TYPE,
                link: toolLink,
                savedAt: new Date().toISOString()
            });
            nowSaved = true;
        } else {
            items.splice(index, 1);
            nowSaved = false;
        }

        setSavedItems(items);
        updateSaveButtonState(saveItemBtn, nowSaved);
        renderSavedItems();
    });

    playbookButton.addEventListener('click', () => {
        playbookOverlay.classList.add('open');
        playbookSidebar.classList.add('open');
    });

    closeBtn.addEventListener('click', () => {
        playbookOverlay.classList.remove('open');
        playbookSidebar.classList.remove('open');
    });

    playbookOverlay.addEventListener('click', (e) => {
        if (e.target === playbookOverlay) {
            playbookOverlay.classList.remove('open');
            playbookSidebar.classList.remove('open');
        }
    });
}

function updateSaveButtonState(button, isSaved) {
    if (!button) return;
    const icon = button.querySelector('i');
    const label = button.querySelector('span');

    if (isSaved) {
        button.classList.add('saved');
        if (icon) {
            icon.classList.remove('far');
            icon.classList.add('fas');
        }
        if (label) label.textContent = 'Saved';
    } else {
        button.classList.remove('saved');
        if (icon) {
            icon.classList.remove('fas');
            icon.classList.add('far');
        }
        if (label) label.textContent = 'Save item';
    }
}

function renderSavedItems() {
    const listEl = document.getElementById('savedItemsList');
    const emptyEl = document.getElementById('savedItemsEmpty');
    if (!listEl || !emptyEl) return;

    const items = getSavedItems();
    listEl.innerHTML = '';

    if (!items.length) {
        emptyEl.style.display = 'block';
        return;
    }

    emptyEl.style.display = 'none';

    items.forEach(item => {
        const li = document.createElement('li');
        li.className = 'saved-item';
        const savedDate = item.savedAt ? new Date(item.savedAt) : null;
        const dateText = savedDate
            ? savedDate.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })
            : '';

        li.innerHTML = `
            <div class="saved-item-title-row">
                <span class="saved-item-title">${item.title}</span>
                <span class="saved-item-type">${item.type}</span>
            </div>
            <div class="saved-item-meta">
                ${dateText ? `Saved on ${dateText}` : ''}
            </div>
            <a class="saved-item-link" href="${item.link}">
                Open <i class="fas fa-arrow-right"></i>
            </a>
        `;
        listEl.appendChild(li);
    });
}

console.log('Team Dysfunction Checklist script loaded');
</script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="assets/supabaseClient.js"></script>
<script src="assets/accessControl.js"></script>
</body>
</html>

