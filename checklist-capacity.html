<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capacity Checklist | The Employee Playbook</title>

    <!-- ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.png">
    <link rel="icon" type="image/png" href="assets/img/favicon.png">

    <style>
        /* ===========================
           ROOT VARIABLES (From Homepage)
        =========================== */
        :root {
            --primary-white: #FFFFFF;
            --light-gray: #F8F9FA;
            --medium-gray: #E9ECEF;
            --dark-gray: #6C757D;
            --text-dark: #212529;
            --text-medium: #495057;
            --accent-purple: #7B5FC4;
            --accent-purple-dark: #5A4496;
            --light-purple: #E6E0F5;
            --lighter-purple: #F0EBFA;
            --border-light: rgba(0, 0, 0, 0.08);
            --hero-gray: #f5f7fa;
            --nav-bg: rgba(255, 255, 255, 0.95);
            --hero-bg: linear-gradient(135deg, #F9F6FF 0%, #F0EBFA 100%);
            --premium-gradient: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --danger-red: #ef4444;
            --info-blue: #3b82f6;
            --teal: #14b8a6;
            --pink: #ec4899;
            --indigo: #6366f1;
            --capacity-green: #059669;
            --capacity-yellow: #d97706;
            --capacity-red: #dc2626;
        }

        /* Dark Mode Variables */
        .dark-mode {
            --primary-white: #1a1a1a;
            --light-gray: #2a2a2a;
            --medium-gray: #3a3a3a;
            --dark-gray: #888888;
            --text-dark: #e0e0e0;
            --text-medium: #b0b0b0;
            --accent-purple: #9d86e9;
            --accent-purple-dark: #7b5fc4;
            --light-purple: rgba(123, 95, 196, 0.2);
            --lighter-purple: rgba(123, 95, 196, 0.1);
            --border-light: rgba(255, 255, 255, 0.08);
            --hero-gray: #2a2a2a;
            --nav-bg: rgba(30, 30, 30, 0.95);
            --hero-bg: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
            --premium-gradient: linear-gradient(135deg, #9d86e9 0%, #7b5fc4 100%);
            --capacity-green: #10b981;
            --capacity-yellow: #f59e0b;
            --capacity-red: #ef4444;
        }

        /* ===========================
           GLOBAL STYLES
        =========================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        body {
            background-color: var(--primary-white);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            opacity: 0;
            transition: opacity 0.4s ease;
            min-height: 100vh;
        }

        body.loaded { opacity: 1; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ===========================
           NAVIGATION (Pixel Perfect from Homepage)
        =========================== */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-light);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, border-color 0.3s ease;
            height: 80px;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            height: 100%;
        }

        .logo-img {
            height: 100px;
            width: auto;
            transform: translateX(20%);
            padding: 14px 10px;
            transition: all 0.3s ease;
            display: block;
            min-height: 100px;
        }

        .logo-img.fallback {
            width: 200px;
            height: 50px;
            background: var(--accent-purple);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            border-radius: 4px;
            transform: translateX(20%);
        }

        .nav-links {
            display: flex;
            gap: 50px;
        }

        .nav-link {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            font-size: 17px;
        }

        .nav-link:hover {
            color: var(--accent-purple);
        }

        .nav-link-container {
            position: relative;
            display: inline-block;
        }

        .new-tag {
            position: absolute;
            top: -12px;
            right: -35px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #000;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
            white-space: nowrap;
        }

        .dark-mode .new-tag {
            box-shadow: 0 2px 4px rgba(0,0,0,0.4);
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 24px;
            transform: translateX(-20%);
        }

        .header-cta {
            background: var(--accent-purple);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(123, 95, 196, 0.3);
        }

        .header-cta:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(123, 95, 196, 0.35);
        }

        .dark-mode .header-cta {
            box-shadow: 0 5px 15px rgba(123, 95, 196, 0.5);
        }

        .sign-in {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            font-size: 17px;
        }

        .sign-in:hover {
            color: var(--accent-purple);
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 16px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .theme-toggle:hover {
            background-color: var(--light-gray);
        }

        .mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .mobile-toggle:hover {
            background-color: var(--light-gray);
        }

        .mobile-sign-in,
        .mobile-sign-up {
            display: none;
        }

        @media (max-width: 768px) {
            .nav-container {
                justify-content: center;
                position: relative;
            }

            .logo {
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                align-items: center;
                height: 100%;
            }

            .logo-img {
                height: 125px;
                transform: none;
                padding: 12px 0;
            }

            .mobile-toggle {
                display: flex;
                position: absolute;
                left: 20px;
                align-items: center;
            }

            .nav-actions {
                transform: none;
                gap: 16px;
                position: absolute;
                right: 20px;
                align-items: center;
            }

            .nav-actions .sign-in,
            .nav-actions .header-cta {
                display: none;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--nav-bg);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                flex-direction: column;
                padding: 20px;
                border-top: 1px solid var(--border-light);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                gap: 20px;
            }

            .nav-links.active {
                display: flex;
            }

            .nav-link-container {
                display: flex;
                align-items: center;
                justify-content: flex-start;
                width: 100%;
            }

            .new-tag {
                position: static;
                margin-left: 8px;
            }

            .mobile-sign-in {
                display: block !important;
                margin-top: 10px;
                padding: 12px 20px;
                background: var(--primary-white);
                color: var(--accent-purple);
                border-radius: 8px;
                text-align: center;
                font-weight: 600;
                text-decoration: none;
                border: 2px solid var(--accent-purple);
                transition: all 0.3s ease;
            }

            .mobile-sign-in:hover {
                background: var(--light-gray);
                transform: translateY(-2px);
            }

            .mobile-sign-up {
                display: block !important;
                margin-top: 10px;
                padding: 12px 20px;
                background: var(--accent-purple);
                color: white;
                border-radius: 8px;
                text-align: center;
                font-weight: 600;
                text-decoration: none;
                border: 2px solid var(--accent-purple);
                transition: all 0.3s ease;
            }

            .mobile-sign-up:hover {
                background: var(--accent-purple-dark);
                transform: translateY(-2px);
            }
        }

        /* ===========================
           ENHANCED HERO SECTION
        =========================== */
        .tool-hero-section {
            width: 100%;
            background: var(--hero-bg);
            padding: 20px 0 30px;
            margin-top: 110px;
            position: relative;
            border-bottom: 1px solid var(--border-light);
            overflow: hidden;
        }

        .tool-hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(135deg, rgba(250, 245, 255, 0.85) 0%, rgba(245, 240, 255, 0.6) 50%, rgba(255, 255, 255, 0.25) 100%);
            z-index: 1;
        }

        .dark-mode .tool-hero-section::before {
            background: linear-gradient(135deg, rgba(42, 42, 42, 0.9) 0%, rgba(31, 31, 31, 0.7) 50%, rgba(26, 26, 26, 0.4) 100%);
        }

        .tool-hero-section::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.06), transparent);
            opacity: 0.25;
            pointer-events: none;
        }

        .dark-mode .tool-hero-section::after {
            background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent);
        }

        .tool-hero-content {
            position: relative;
            z-index: 2;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px 10px;
            animation: heroFadeUp 0.45s ease-out;
        }

        @keyframes heroFadeUp {
            from {
                opacity: 0;
                transform: translateY(18px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Breadcrumb styling */
        .breadcrumb {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--dark-gray);
            margin-bottom: 10px;
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .breadcrumb a {
            color: var(--text-medium);
            text-decoration: none !important;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: var(--accent-purple-dark);
        }

        .breadcrumb span {
            color: var(--text-medium);
        }

        .breadcrumb i {
            color: var(--dark-gray);
            opacity: 0.8;
        }

        .breadcrumb .current {
            color: var(--text-dark);
            font-weight: 600;
        }

        /* Save Item button in hero (top-right of hero) */
        .save-btn {
            position: absolute;
            top: 16px;
            right: 24px;
            z-index: 5;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
            border-radius: 999px;
            border: 1px solid rgba(123, 95, 196, 0.6);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: var(--accent-purple-dark);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .save-btn i {
            font-size: 13px;
        }

        .save-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(123, 95, 196, 0.18);
            background: #ffffff;
        }

        .dark-mode .save-btn {
            background: rgba(20, 20, 20, 0.9);
            border-color: rgba(157, 134, 233, 0.6);
        }

        .save-btn.saved {
            background: var(--accent-purple);
            color: #ffffff;
            border-color: transparent;
        }

        .save-btn.saved i {
            font-weight: 700;
        }

        .checklist-name {
            font-size: 20px;
            font-weight: 600;
            color: var(--accent-purple);
            text-transform: uppercase;
            letter-spacing: 1.8px;
            margin-bottom: 14px;
            margin-top: 32px;
            display: block;
        }

        .hero-main-heading {
            font-size: 46px;
            font-weight: 600;
            color: var(--text-dark);
            line-height: 1.1;
            margin-bottom: 20px;
            max-width: 1100px;
        }

        .hero-subheading {
            font-size: 16px;
            color: var(--text-medium);
            line-height: 1.6;
            max-width: 9000px;
            margin-bottom: 30px;
        }

        /* ===========================
           CATEGORY PILLS SECTION - UPDATED COLOURS
        =========================== */
        .category-pills-container {
            margin-bottom: 30px;
        }

        .category-pills-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-medium);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 14px;
            display: block;
        }

        .category-pills-grid {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .category-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid transparent;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            text-decoration: none;
            height: 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
        }

        .dark-mode .category-pill {
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .category-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            text-decoration: none;
        }

        .dark-mode .category-pill:hover {
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.35);
        }

        /* UPDATED Category Pill Colors */
        .category-pill.capacity {
            color: #7B5FC4;
            border-color: rgba(123, 95, 196, 0.2);
            background: linear-gradient(135deg, rgba(123, 95, 196, 0.08), rgba(123, 95, 196, 0.04));
        }

        .dark-mode .category-pill.capacity {
            color: #9d86e9;
            border-color: rgba(157, 134, 233, 0.3);
            background: linear-gradient(135deg, rgba(123, 95, 196, 0.18), rgba(123, 95, 196, 0.1));
        }

        .category-pill.evidence {
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.2);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(16, 185, 129, 0.04));
        }

        .dark-mode .category-pill.evidence {
            color: #34d399;
            border-color: rgba(52, 211, 153, 0.3);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.18), rgba(16, 185, 129, 0.1));
        }

        .category-pill.boundaries {
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.2);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(239, 68, 68, 0.04));
        }

        .dark-mode .category-pill.boundaries {
            color: #f87171;
            border-color: rgba(248, 113, 113, 0.3);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.18), rgba(239, 68, 68, 0.1));
        }

        .category-icon {
            font-size: 11px;
            opacity: 0.8;
            flex-shrink: 0;
        }

        /* ===========================
           CONTEXT & PRO TIPS SECTION
        =========================== */
        .context-tips-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 40px;
            width: 100%;
            max-width: 1100px;
            margin: 0 auto 50px;
            padding: 24px 20px 10px;
            margin-top: 6px;
        }

        .context-card, .tips-card {
            background: var(--primary-white);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 28px 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .dark-mode .context-card,
        .dark-mode .tips-card {
            box-shadow: 0 2px 8px rgba(0,0,0,0.22);
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }

        .section-title i {
            color: var(--accent-purple);
        }

        .bullet-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .bullet-list li {
            color: var(--text-medium);
            line-height: 1.6;
            margin-bottom: 14px;
            padding-left: 26px;
            position: relative;
        }

        .bullet-list li::before {
            content: "•";
            position: absolute;
            left: 10px;
            color: var(--accent-purple);
            font-size: 18px;
        }

        /* ===========================
           CHECKLIST BODY
        =========================== */
        .checklist-body {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px 20px;
        }

        .checklist-section-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--accent-purple-dark);
            margin-bottom: 18px;
            margin-top: 60px !important;
        }

        .checklist-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .checklist-item {
            background: var(--primary-white);
            padding: 14px 16px;
            border-radius: 10px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
            border: 1px solid var(--border-light);
            display: flex;
            gap: 12px;
            align-items: flex-start;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            height: 100%;
            min-height: 70px;
        }

        .dark-mode .checklist-item {
            box-shadow: 0 1px 4px rgba(0,0,0,0.14);
        }

        .checklist-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        .dark-mode .checklist-item:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.28);
        }

        .checklist-item i {
            color: var(--accent-purple);
            font-size: 18px;
            margin-top: 3px;
            flex-shrink: 0;
        }

        .checklist-text {
            flex: 1;
            color: var(--text-medium);
            font-size: 15px;
            line-height: 1.5;
        }

        /* ===========================
           CAPACITY METER SECTION
        =========================== */
        .capacity-meter-section {
            max-width: 1100px;
            margin: 25px auto 40px;
            padding: 0 20px;
        }

        .capacity-header {
            margin-bottom: 18px;
            text-align: left;
        }

        .capacity-header h2 {
            font-size: 22px;
            font-weight: 700;
            color: var(--accent-purple-dark);
            margin-bottom: 6px;
        }

        .capacity-header p {
            font-size: 14px;
            color: var(--text-medium);
            max-width: 1100px;
            line-height: 1.5;
        }

        .capacity-meter-container {
            display: flex;
            align-items: stretch;
            gap: 30px;
            background: var(--primary-white);
            border-radius: 16px;
            padding: 22px 24px 20px;
            box-shadow: 0 8px 30px rgba(123, 95, 196, 0.12);
            border: 1px solid rgba(123, 95, 196, 0.15);
        }

        .dark-mode .capacity-meter-container {
            box-shadow: 0 8px 30px rgba(123, 95, 196, 0.25);
            border: 1px solid rgba(123, 95, 196, 0.35);
        }

        .capacity-progress-container {
            flex: 1.4;
        }

        .capacity-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .capacity-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-purple-dark);
        }

        .capacity-status {
            font-size: 20px;
            font-weight: 800;
            padding: 4px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-green {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--capacity-green);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .status-yellow {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--capacity-yellow);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .status-red {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--capacity-red);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .capacity-meter {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 6px;
            position: relative;
        }

        .dark-mode .capacity-meter {
            background: rgba(255, 255, 255, 0.12);
        }

        .meter-fill {
            height: 100%;
            width: 0%;
            border-radius: 5px;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .meter-green {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .meter-yellow {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .meter-red {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .meter-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--dark-gray);
        }

        .capacity-dimensions {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
            margin-top: 14px;
        }

        .capacity-dimension-pill {
            border-radius: 10px;
            padding: 8px 10px;
            border: 1px solid var(--border-light);
            background: var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: var(--text-medium);
        }

        .dark-mode .capacity-dimension-pill {
            background: rgba(255,255,255,0.04);
            border-color: rgba(255,255,255,0.1);
        }

        .capacity-dimension-pill span.label {
            font-weight: 600;
            color: var(--text-dark);
        }

        .capacity-dimension-pill span.score {
            font-weight: 700;
            color: var(--accent-purple);
        }

        .actions-container {
            display: flex;
            gap: 12px;
            flex-shrink: 0;
            flex-direction: column;
            justify-content: center;
            align-items: stretch;
            max-width: 260px;
        }

        .action-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            padding: 10px 18px;
            font-size: 13.5px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            width: 100%;
            justify-content: center;
        }

        .action-btn i {
            font-size: 14px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.3);
        }

        .dark-mode .action-btn:hover {
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.4);
        }

        .action-btn.secondary {
            background: var(--light-purple);
            color: var(--accent-purple-dark);
        }

        .dark-mode .action-btn.secondary {
            background: rgba(123, 95, 196, 0.21);
            color: var(--accent-purple);
        }

        .action-btn.secondary:hover {
            background: var(--accent-purple);
            color: white;
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* ===========================
           EVIDENCE WORKLOAD SECTION
        =========================== */
        .evidence-section {
            max-width: 1100px;
            margin: 0 auto 60px;
            padding: 0 20px;
            display: none;
        }

        .evidence-section.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .evidence-header {
            text-align: center;
            margin-bottom: 28px;
        }

        .evidence-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-purple-dark);
            margin-bottom: 6px;
        }

        .evidence-subtitle {
            color: var(--text-medium);
            font-size: 16px;
            margin-bottom: 8px;
        }

        .evidence-insight {
            font-size: 14px;
            color: var(--dark-gray);
            max-width: 680px;
            margin: 0 auto;
        }

        /* Section Headers */
        .section-header {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
        }

        .section-header.red {
            color: var(--danger-red);
        }

        .section-header.purple {
            color: var(--accent-purple-dark);
        }

        .section-header.blue {
            color: var(--accent-purple);
        }

        /* Red Flags Grid - 3 in a row */
        .evidence-facts-grid,
        .conversation-grid,
        .boundary-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .evidence-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .dark-mode .evidence-card {
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.18);
            border: 1px solid rgba(16, 185, 129, 0.22);
        }

        .evidence-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
        }

        .evidence-icon {
            font-size: 20px;
            color: var(--accent-purple);
            margin-bottom: 15px;
            width: 40px;
            height: 40px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode .evidence-icon {
            background: rgba(16, 185, 129, 0.2);
        }

        .evidence-title-text {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .evidence-description {
            color: var(--text-medium);
            font-size: 14px;
            line-height: 1.5;
            flex-grow: 1;
        }

        /* Conversation Grid - 3 in a row */
        .conversation-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.08);
            border: 1px solid rgba(123, 95, 196, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .dark-mode .conversation-card {
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.21);
            border: 1px solid rgba(123, 95, 196, 0.25);
        }

        .conversation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
        }

        .conversation-icon {
            font-size: 20px;
            color: var(--accent-purple);
            margin-bottom: 15px;
            width: 40px;
            height: 40px;
            background: var(--lighter-purple);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode .conversation-icon {
            background: rgba(123, 95, 196, 0.21);
        }

        .conversation-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .conversation-description {
            color: var(--text-medium);
            font-size: 14px;
            line-height: 1.5;
            flex-grow: 1;
        }

        /* Boundary Grid - 3 in a row */
        .boundary-card {
            background: var(--primary-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.08);
            border: 1px solid rgba(123, 95, 196, 0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
            transition: all 0.2s ease;
        }

        .dark-mode .boundary-card {
            box-shadow: 0 4px 12px rgba(123, 95, 196, 0.21);
            border: 1px solid rgba(123, 95, 196, 0.25);
        }

        .boundary-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.16);
        }

        .dark-mode .boundary-card:hover {
            box-shadow: 0 8px 20px rgba(123, 95, 196, 0.25);
        }

        .boundary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);
        }

        .boundary-icon {
            font-size: 20px;
            color: var(--accent-purple);
            margin-bottom: 15px;
            width: 40px;
            height: 40px;
            background: var(--lighter-purple);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dark-mode .boundary-icon {
            background: rgba(123, 95, 196, 0.21);
        }

        .boundary-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .boundary-description {
            color: var(--text-medium);
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .boundary-link {
            color: var(--accent-purple);
            font-weight: 600;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: auto;
        }

        .boundary-link:hover {
            text-decoration: underline;
        }

        /* ===========================
           MY PLAYBOOK FLOATING BUTTON + SIDEBAR
        =========================== */
        .my-playbook-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1200;
            background: var(--premium-gradient);
            color: #ffffff;
            padding: 10px 16px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
            transition: all 0.25s ease;
        }

        .my-playbook-fab i {
            font-size: 15px;
        }

        .my-playbook-fab:hover {
            transform: translateY(-3px);
            box-shadow: 0 14px 30px rgba(0,0,0,0.32);
        }

        .playbook-sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.45);
            z-index: 1190;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
        }

        .playbook-sidebar-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        .playbook-sidebar {
            position: fixed;
            top: 0;
            right: -380px;
            width: 340px;
            max-width: 90%;
            height: 100%;
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            box-shadow: -4px 0 20px rgba(0,0,0,0.25);
            z-index: 1191;
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--border-light);
            transition: right 0.25s ease;
        }

        .dark-mode .playbook-sidebar {
            background: rgba(18, 18, 18, 0.96);
            box-shadow: -4px 0 22px rgba(0,0,0,0.6);
        }

        .playbook-sidebar.open {
            right: 0;
        }

        .playbook-sidebar-header {
            padding: 20px 20px 14px;
            border-bottom: 1px solid var(--border-light);
        }

        .playbook-sidebar-header-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .playbook-sidebar-header h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-dark);
        }

        .playbook-sidebar-header p {
            font-size: 13px;
            color: var(--dark-gray);
        }

        .playbook-close-btn {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 18px;
            border-radius: 999px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        .playbook-close-btn:hover {
            background: var(--light-gray);
        }

        .playbook-sidebar-body {
            padding: 14px 18px 20px;
            padding-bottom: 50px; /* prevents overlap with floating button */            
            overflow-y: auto;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .saved-items-empty {
            font-size: 13px;
            color: var(--dark-gray);
            line-height: 1.6;
        }

        .saved-items-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .saved-item {
            padding: 10px 8px 10px;
            border-radius: 10px;
            border: 1px solid var(--border-light);
            background: var(--primary-white);
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .saved-item-title-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 6px;
        }

        .saved-item-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .saved-item-type {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            color: var(--accent-purple-dark);
        }

        .saved-item-meta {
            font-size: 12px;
            color: var(--dark-gray);
        }

        .saved-item-link {
            margin-top: 6px;
            font-size: 12px;
            color: var(--accent-purple);
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .saved-item-link:hover {
            text-decoration: underline;
        }

        /* ===========================
        QUICK LINKS — CLEAN VERSION
        =========================== */
        .playbook-quick-links {
            margin-top: 223px;               /* move the whole section lower */
            padding-top: 10px;
            border-top: 1px solid var(--border-light);
        }

        .playbook-quick-links-header {
            margin-bottom: 4px;
        }

        .quick-links-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-medium);
        }

        .playbook-quick-links-list {
            display: flex;
            flex-direction: column;         /* stack vertically */
            gap: 10px;                      /* spacing between pills */
            margin-top: 6px;                /* subtle space under the heading */
        }

        /* --- Quick Link Pill --- */
        .quick-link-pill {
            width: 50%;                     /* narrower pill width */
            padding: 4px 4px;
            border-radius: 999px;
            border: 1px solid rgba(123, 95, 196, 0.35);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.08),rgba(123, 95, 196, 0.02));
            text-decoration: none;
            color: var(--accent-purple-dark);
            font-size: 13px;
            font-weight: 500;
           
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-link-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.12);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.16), rgba(123, 95, 196, 0.06));
        }

        .quick-link-pill i {
            font-size: 14px;
        }

        .dark-mode .quick-link-pill {
            border-color: rgba(157, 134, 233, 0.55);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.26),rgba(123, 95, 196, 0.12));
        }

        /* ===========================
           FOOTER
        =========================== */
        footer {
            background: var(--primary-white);
            padding: 10px 0;
            border-top: 1px solid var(--border-light);
            margin-top: 30px;
            text-align: center;
            color: var(--text-medium);
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .context-tips-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .evidence-facts-grid,
            .conversation-grid,
            .boundary-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .checklist-grid {
                grid-template-columns: 1fr;
            }

            .checklist-section-title {
                margin-top: 50px !important;
            }

            .capacity-meter-container {
                flex-direction: column;
            }

            .actions-container {
                max-width: 100%;
                flex-direction: row;
            }
        }

        @media (max-width: 768px) {
            .tool-hero-section {
                margin-top: 100px;
            }

            .context-tips-grid {
                padding: 20px 20px 10px;
                margin-top: 5px;
            }

            .context-card, .tips-card {
                padding: 24px;
            }

            .section-title {
                font-size: 18px;
                white-space: normal;
            }

            .hero-main-heading {
                font-size: 36px;
            }

            .hero-subheading {
                font-size: 16px;
                max-width: 100%;
            }

            .capacity-meter-container {
                padding: 18px 18px 18px;
            }

            .actions-container {
                flex-direction: column;
                align-items: stretch;
            }

            .evidence-facts-grid,
            .conversation-grid,
            .boundary-grid {
                grid-template-columns: 1fr;
            }

            .category-pills-grid {
                justify-content: flex-start;
            }

            .checklist-section-title {
                margin-top: 40px !important;
            }

            .save-btn {
                right: 18px;
                top: 10px;
            }

            .my-playbook-fab {
                bottom: 18px;
                right: 18px;
            }
        }

        @media (max-width: 480px) {
            .hero-main-heading {
                font-size: 32px;
            }

            .checklist-name {
                font-size: 18px;
            }

            .evidence-title {
                font-size: 22px;
            }

            .section-header {
                font-size: 18px;
            }

            .capacity-status {
                font-size: 16px;
            }

            .category-pill {
                font-size: 11px;
                padding: 5px 10px;
                height: 30px;
            }

            .checklist-item {
                padding: 12px 14px;
                min-height: 65px;
            }

            .checklist-text {
                font-size: 14px;
            }

            .checklist-section-title {
                margin-top: 30px !important;
            }

            .capacity-dimensions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

<!-- ===========================
     NAVIGATION
=========================== -->
<nav>
    <div class="container nav-container">
        <button class="mobile-toggle"><i class="fas fa-bars"></i></button>

        <a href="index.html" class="logo">
            <img src="./assets/img/logo.png" alt="The Employee Playbook" class="logo-img" id="mainLogo">
        </a>

        <div class="nav-links">
            <a href="the-lens.html" class="nav-link">The Lens</a>
            <a href="the-toolkit.html" class="nav-link">The Toolkit</a>
            <div class="nav-link-container">
                <a href="the-coach.html" class="nav-link">The Coach</a>
                <span class="new-tag">NEW</span>
            </div>
            <a href="the-shift.html" class="nav-link">The Shift</a>
            <a href="the-pricing.html" class="nav-link">The Pricing</a>
            <a href="sign-in.html" class="mobile-sign-in">Sign In</a>
            <a href="create-account.html" class="mobile-sign-up">Sign Up</a>
        </div>

        <div class="nav-actions">
            <a href="create-account.html" class="header-cta">Sign up</a>
            <a href="sign-in.html" class="sign-in">Sign in</a>
            <button class="theme-toggle" id="themeToggleBtn"><i class="fas fa-moon"></i></button>
        </div>
    </div>
</nav>

<!-- ===========================
     ENHANCED HERO SECTION
=========================== -->
<div class="tool-hero-section">
    <!-- Save button anchored to hero -->
    <button class="save-btn" id="saveBtn">
        <i class="far fa-bookmark"></i>
        <span>Save</span>
    </button>

    <div class="tool-hero-content">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <a href="the-toolkit.html">Toolkit</a>
            <i class="fas fa-chevron-right"></i>
            <a href="workload-boundaries-and-capacity.html">
                Workload, Boundaries & Capacity
            </a>
            <i class="fas fa-chevron-right"></i>
            <span class="current">Capacity Checklist</span>
        </div>

        <!-- Checklist name (purple, 20% bigger) -->
        <span class="checklist-name">
            CAPACITY CHECKLIST
        </span>

        <!-- Main hero heading (black, large) with reduced space above -->
        <h1 class="hero-main-heading">Facts Over Feelings → Workload Evidence</h1>

        <!-- Hero subheading -->
        <div class="hero-subheading">
            When you're overwhelmed or feel at capacity, use this tool to move from subjective feelings to objective evidence. 
            Collect concrete data about your actual workload to have better conversations about priorities, deadlines, and what's truly possible.
        </div>

        <!-- Category Pills - UPDATED FOR CAPACITY REALITY CHECK -->
        <div class="category-pills-container">
            <span class="category-pills-title">Explore Categories</span>

            <div class="category-pills-grid">
                <a href="evidence-based-conversations.html" class="category-pill evidence">
                    <i class="fas fa-chart-bar category-icon"></i>
                    <span>Evidence-Based Conversations</span>
                </a>

                <a href="boundary-setting-and-advocacy.html" class="category-pill boundaries">
                    <i class="fas fa-shield-alt category-icon"></i>
                    <span>Boundary Setting & Advocacy</span>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- ===========================
     CONTEXT & PRO TIPS SECTION
=========================== -->
<div class="context-tips-grid">
    <div class="context-card">
        <h3 class="section-title"><i class="fas fa-calendar-check"></i>When to Use This Checklist</h3>
        <ul class="bullet-list">
            <li>When you feel constantly overwhelmed or at capacity</li>
            <li>Before having a conversation with your manager about workload</li>
            <li>When you're being asked to take on additional responsibilities</li>
            <li>When you need to push back on unrealistic deadlines or expectations</li>
            <li>When you suspect your actual workload doesn't match your role or level</li>
            <li>When planning for the next quarter or performance review</li>
        </ul>
    </div>

    <div class="tips-card">
        <h3 class="section-title"><i class="fas fa-lightbulb"></i>Pro Tips</h3>
        <ul class="bullet-list">
            <li>Track your actual time for 1-2 weeks for the most accurate data</li>
            <li>Include meetings, email, and "invisible work" in your calculations</li>
            <li>Be specific with your evidence - numbers are more persuasive than feelings</li>
            <li>Use this as a collaborative tool, not a weapon against your manager</li>
            <li>Focus on solutions, not just problems - bring options to the conversation</li>
            <li>Update this regularly as your role and responsibilities evolve</li>
        </ul>
    </div>
</div>

<!-- ===========================
     CHECKLIST BODY CONTENT
=========================== -->
<div class="checklist-body" id="checklistText">

    <h2 class="checklist-section-title">Your Capacity Checklist</h2>

    <div class="checklist-grid">
        <div class="checklist-item" data-category="tracking">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've tracked my actual time spent on different types of work for at least one full week.</div>
        </div>
        <div class="checklist-item" data-category="hours">
            <i class="far fa-square"></i>
            <div class="checklist-text">I know how many hours I'm actually working each week (not just "feels like" a lot).</div>
        </div>
        <div class="checklist-item" data-category="meetings">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've calculated what percentage of my week is spent in meetings versus focused work.</div>
        </div>
        <div class="checklist-item" data-category="invisible">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've accounted for "invisible work" - emails, quick questions, administrative tasks, context switching.</div>
        </div>
        <div class="checklist-item" data-category="scope">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've documented all my current responsibilities and projects with estimated time requirements.</div>
        </div>
        <div class="checklist-item" data-category="comparison">
            <i class="far fa-square"></i>
            <div class="checklist-text">I can compare my current workload to my job description or role expectations.</div>
        </div>
        <div class="checklist-item" data-category="sustainability">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've assessed whether my current workload is sustainable long-term without burnout.</div>
        </div>
        <div class="checklist-item" data-category="growth">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've identified what percentage of my time is spent on growth vs maintenance work.</div>
        </div>
        <div class="checklist-item" data-category="priority-time">
            <i class="far fa-square"></i>
            <div class="checklist-text">I know how much time I actually have for priority work versus reactive work.</div>
        </div>
        <div class="checklist-item" data-category="buffer">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've calculated what buffer I have for unexpected work or emergencies.</div>
        </div>
        <div class="checklist-item" data-category="data-visual">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've created a visual (chart, graph, or simple summary) of my workload distribution.</div>
        </div>
        <div class="checklist-item" data-category="options">
            <i class="far fa-square"></i>
            <div class="checklist-text">I've identified what could be deprioritised, delegated, or done differently to create capacity.</div>
        </div>
    </div>
</div>

<!-- ===========================
     CAPACITY METER SECTION
=========================== -->
<div class="capacity-meter-section">
    <div class="capacity-header">
        <h2>Your Capacity Scorer</h2>
        <p>
            Your Capacity Score shows how well you understand your actual workload versus perceived workload. 
            High scores mean you have strong evidence about your capacity; low scores indicate you're operating 
            on feelings rather than facts. Use this to build evidence for workload conversations.
        </p>
    </div>

    <div class="capacity-meter-container">
        <div class="capacity-progress-container">
            <div class="capacity-title-row">
                <div class="capacity-title">Capacity Evidence Score</div>
                <div class="capacity-status" id="capacityStatus">Gathering Data</div>
            </div>
            <div class="capacity-meter">
                <div class="meter-fill" id="meterFill"></div>
            </div>
            <div class="meter-labels">
                <span>Operating on Feelings</span>
                <span>Some Evidence</span>
                <span>Strong Evidence Base</span>
            </div>

            <div class="capacity-dimensions">
                <div class="capacity-dimension-pill">
                    <span class="label">Time Tracking</span>
                    <span class="score" id="scoreTracking">0%</span>
                </div>
                <div class="capacity-dimension-pill">
                    <span class="label">Workload Analysis</span>
                    <span class="score" id="scoreAnalysis">0%</span>
                </div>
                <div class="capacity-dimension-pill">
                    <span class="label">Evidence Quality</span>
                    <span class="score" id="scoreEvidence">0%</span>
                </div>
                <div class="capacity-dimension-pill">
                    <span class="label">Solution Thinking</span>
                    <span class="score" id="scoreSolutions">0%</span>
                </div>
            </div>
        </div>

        <div class="actions-container">
            <button class="action-btn" onclick="generateEvidenceSummary()" id="generateBtn" disabled>
                <i class="fas fa-chart-bar"></i> Generate Evidence Report
            </button>
            <button class="action-btn secondary" onclick="copyChecklist()" id="copyBtn">
                <i class="far fa-copy"></i> Copy Checklist
            </button>
        </div>
    </div>
</div>

<!-- ===========================
     EVIDENCE WORKLOAD SECTION
=========================== -->
<div class="evidence-section" id="evidenceSummary">
    <div class="evidence-header">
        <h2 class="evidence-title">Your Workload Evidence Report</h2>
        <p class="evidence-subtitle">Based on your Capacity Evidence Score of <span id="summaryScore">0%</span> • Status: <span id="summaryStatus">Gathering Data</span></p>
        <p class="evidence-insight">
            This report transforms feelings into facts. Use it to have evidence-based conversations about workload, 
            priorities, and realistic expectations. Numbers are more persuasive than emotions.
        </p>
    </div>

    <h3 class="section-header purple">
        <i class="fas fa-chart-pie"></i> Key Workload Evidence
    </h3>
    <div class="evidence-facts-grid" id="evidenceFactsGrid">
        <!-- Evidence facts will be generated here -->
    </div>

    <h3 class="section-header blue">
        <i class="fas fa-comments"></i> Conversation Starters
    </h3>
    <div class="conversation-grid" id="conversationGrid">
        <!-- Conversation starters will be generated here -->
    </div>

    <h3 class="section-header purple">
        <i class="fas fa-tools"></i> Capacity Building Strategies
    </h3>
    <div class="boundary-grid" id="boundaryGrid">
        <!-- Strategies will be generated here -->
    </div>
</div>

<!-- ===========================
     MY PLAYBOOK SIDEBAR
=========================== -->
<div class="playbook-sidebar-overlay" id="playbookOverlay">
    <div class="playbook-sidebar" id="playbookSidebar">
        <div class="playbook-sidebar-header">
            <div class="playbook-sidebar-header-title-row">
                <h3>My Playbook</h3>
                <button class="playbook-close-btn" id="closePlaybook" aria-label="Close My Playbook">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p>Saved items</p>
        </div>
        <div class="playbook-sidebar-body">
            <div id="savedItemsContainer">
                <p class="saved-items-empty" id="savedItemsEmpty">
                    You haven't saved anything yet. Use <strong>Save item</strong> on tools you want quick access to.
                </p>
                <ul class="saved-items-list" id="savedItemsList"></ul>
            </div>

            <!-- Quick links at bottom -->
            <div class="playbook-quick-links">
                <div class="playbook-quick-links-header">
                    <span class="quick-links-title">Quick links</span>
                </div>
                <div class="playbook-quick-links-list">
                    <a href="dashboard.html" class="quick-link-pill">
                        <i class="fas fa-gauge"></i> The Dashboard
                    </a>                    
                    <a href="the-lens.html" class="quick-link-pill">
                        <i class="fas fa-search"></i> The Lens
                    </a>
                    <a href="the-toolkit.html" class="quick-link-pill">
                        <i class="fas fa-toolbox"></i> The Toolkit
                    </a>
                    <a href="the-coach.html" class="quick-link-pill">
                        <i class="fas fa-comments"></i> The Coach
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Floating My Playbook button -->
<div class="my-playbook-fab" id="myPlaybookButton">
    <i class="fas fa-book-open"></i>
    <span>My Playbook</span>
</div>

<!-- ===========================
     FOOTER
=========================== -->
<footer>
    <div class="container">
        <p>© 2025 The Employee Playbook. All rights reserved.</p>
    </div>
</footer>

<!-- ===========================
     JAVASCRIPT
=========================== -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM fully loaded and parsed');
    
    document.body.classList.add('loaded');
    
    // Initialize checklist functionality
    initializeChecklist();
    
    // Initialize theme toggle
    initializeThemeToggle();
    
    // Initialize mobile navigation
    initializeMobileNav();
    
    // Initialize My Playbook functionality
    initializePlaybook();
});

/* ===========================
   MOBILE NAV
=========================== */
function initializeMobileNav() {
    const mobileToggle = document.querySelector('.mobile-toggle');
    const navLinks = document.querySelector('.nav-links');
    
    if (mobileToggle) {
        mobileToggle.addEventListener('click', function () {
            navLinks.classList.toggle('active');
            const icon = this.querySelector('i');
            if (icon) {
                icon.classList.toggle('fa-bars');
                icon.classList.toggle('fa-times');
            }
        });
    } else {
        console.error('Mobile toggle button not found');
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
        if (navLinks.classList.contains('active') && 
            !navLinks.contains(event.target) && 
            !mobileToggle.contains(event.target)) {
            navLinks.classList.remove('active');
            if (mobileToggle) {
                const icon = mobileToggle.querySelector('i');
                if (icon) {
                    icon.classList.add('fa-bars');
                    icon.classList.remove('fa-times');
                }
            }
        }
    });
}

/* ===========================
   THEME TOGGLE
=========================== */
function initializeThemeToggle() {
    const themeToggleBtn = document.getElementById('themeToggleBtn');
    if (!themeToggleBtn) {
        console.error('Theme toggle button not found');
        return;
    }
    
    const themeIcon = themeToggleBtn.querySelector('i');
    const logoImg = document.getElementById('mainLogo');
    
    console.log('Logo element:', logoImg);
    
    // Function to get correct file path
    function getLogoPath(filename) {
        // Check if we're running from file system
        if (window.location.protocol === 'file:') {
            // For file:// protocol, we need to calculate the path
            const currentPath = window.location.pathname;
            const basePath = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
            return basePath + 'assets/img/' + filename;
        } else {
            // For http:// or https:// protocol, use relative path
            return './assets/img/' + filename;
        }
    }
    
    // Function to create fallback logo
    function createFallbackLogo(isDarkMode) {
        if (!logoImg) return;
        
        logoImg.classList.add('fallback');
        if (isDarkMode) {
            logoImg.style.background = 'var(--accent-purple)';
            logoImg.style.color = 'white';
        } else {
            logoImg.style.background = 'var(--accent-purple)';
            logoImg.style.color = 'white';
        }
        
        // Create text fallback
        const logoText = document.createElement('div');
        logoText.textContent = 'THE EMPLOYEE PLAYBOOK';
        logoText.style.fontSize = '14px';
        logoText.style.fontWeight = '700';
        logoText.style.letterSpacing = '1px';
        
        // Clear image and add text
        logoImg.src = '';
        logoImg.alt = 'The Employee Playbook';
        logoImg.style.display = 'flex';
        logoImg.style.alignItems = 'center';
        logoImg.style.justifyContent = 'center';
        logoImg.innerHTML = '';
        logoImg.appendChild(logoText);
    }
    
    // Function to update logo based on theme
    function updateLogoForTheme(isDarkMode) {
        if (!logoImg) {
            console.error('Logo image element not found');
            return;
        }
        
        // Remove fallback class if it exists
        logoImg.classList.remove('fallback');
        
        if (isDarkMode) {
            // Try dark logo
            const darkLogoPath = getLogoPath('logo-dark.png');
            console.log('Attempting to load dark logo from:', darkLogoPath);
            logoImg.src = darkLogoPath;
        } else {
            // Use light logo
            const lightLogoPath = getLogoPath('logo.png');
            console.log('Loading light logo from:', lightLogoPath);
            logoImg.src = lightLogoPath;
        }
        
        // Restore alt text
        logoImg.alt = 'The Employee Playbook';
    }
    
    // Check for saved theme or prefer-color-scheme
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    const savedTheme = localStorage.getItem('theme');
    
    // Initialize theme based on saved preference or system
    if (savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches)) {
        document.body.classList.add('dark-mode');
        if (themeIcon) {
            themeIcon.classList.remove('fa-moon');
            themeIcon.classList.add('fa-sun');
        }
        updateLogoForTheme(true);
    } else {
        // Ensure light mode is set properly
        document.body.classList.remove('dark-mode');
        if (themeIcon) {
            themeIcon.classList.remove('fa-sun');
            themeIcon.classList.add('fa-moon');
        }
        updateLogoForTheme(false);
    }
    
    themeToggleBtn.addEventListener('click', function() {
        const isDarkMode = document.body.classList.contains('dark-mode');
        
        if (isDarkMode) {
            // Switching to light mode
            document.body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light');
            if (themeIcon) {
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            }
            updateLogoForTheme(false);
        } else {
            // Switching to dark mode
            document.body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark');
            if (themeIcon) {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            }
            updateLogoForTheme(true);
        }
    });
    
    // Listen for system theme changes
    prefersDarkScheme.addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
            if (e.matches) {
                document.body.classList.add('dark-mode');
                if (themeIcon) {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                }
                updateLogoForTheme(true);
            } else {
                document.body.classList.remove('dark-mode');
                if (themeIcon) {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                }
                updateLogoForTheme(false);
            }
        }
    });
    
    // Handle logo loading errors (fallback to text logo)
    if (logoImg) {
        logoImg.addEventListener('error', function() {
            console.error('Logo failed to load:', this.src);
            
            // Check current theme for fallback
            const isDarkMode = document.body.classList.contains('dark-mode');
            
            // If this is dark logo failing, try light logo first
            if (this.src.includes('logo-dark.png')) {
                console.warn('Dark logo not found, trying light logo...');
                const lightLogoPath = getLogoPath('logo.png');
                this.src = lightLogoPath;
                // If light logo also fails, it will trigger another error event
            } else {
                // Both logos failed, use fallback
                console.warn('Both logos failed, using fallback text logo');
                createFallbackLogo(isDarkMode);
            }
        });
        
        logoImg.addEventListener('load', function() {
            console.log('Logo loaded successfully:', this.src);
            // Ensure fallback class is removed
            this.classList.remove('fallback');
        });
    }
}

/* ===========================
   CHECKLIST LOGIC
=========================== */
let checkedItems = [];
let itemCategories = [];

const dimensionConfig = {
    tracking: ['tracking', 'hours', 'meetings'],
    analysis: ['invisible', 'scope', 'comparison', 'sustainability'],
    evidence: ['growth', 'priority-time', 'buffer', 'data-visual'],
    solutions: ['options']
};

function initializeChecklist() {
    const checklistContainers = document.querySelectorAll('.checklist-item');
    checkedItems = new Array(checklistContainers.length).fill(false);
    itemCategories = [];

    checklistContainers.forEach((container, index) => {
        const icon = container.querySelector('i');
        const category = container.getAttribute('data-category');
        itemCategories[index] = category;

        container.addEventListener('click', function(e) {
            if (e.target.tagName === 'BUTTON') return;

            if (icon.classList.contains('fa-square')) {
                icon.classList.remove('fa-square');
                icon.classList.add('fa-check-square');
                icon.style.color = '#5A4496';
                checkedItems[index] = true;
            } else {
                icon.classList.remove('fa-check-square');
                icon.classList.add('fa-square');
                icon.style.color = '#7B5FC4';
                checkedItems[index] = false;
            }
            
            updateCapacityScore();
        });
    });
    
    // Initialize checkedItems array
    checkedItems = new Array(checklistContainers.length).fill(false);
}

function updateCapacityScore() {
    const checkedCount = checkedItems.filter(Boolean).length;
    const totalCount = checkedItems.length;
    const capacityScore = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;
    
    // Update meter and status
    const meterFill = document.getElementById('meterFill');
    const capacityStatus = document.getElementById('capacityStatus');
    
    meterFill.style.width = capacityScore + '%';
    
    // Update meter color and status based on score
    meterFill.classList.remove('meter-green', 'meter-yellow', 'meter-red');
    capacityStatus.classList.remove('status-green', 'status-yellow', 'status-red');
    
    if (capacityScore >= 75) {
        meterFill.classList.add('meter-green');
        capacityStatus.classList.add('status-green');
        capacityStatus.textContent = 'Strong Evidence';
    } else if (capacityScore >= 40) {
        meterFill.classList.add('meter-yellow');
        capacityStatus.classList.add('status-yellow');
        capacityStatus.textContent = 'Moderate Evidence';
    } else {
        meterFill.classList.add('meter-red');
        capacityStatus.classList.add('status-red');
        capacityStatus.textContent = 'Gathering Data';
    }
    
    // Enable/disable generate button
    document.getElementById('generateBtn').disabled = checkedCount === 0;
    
    // Calculate dimension scores
    const dimensionScores = {
        tracking: { checked: 0, total: 0 },
        analysis: { checked: 0, total: 0 },
        evidence: { checked: 0, total: 0 },
        solutions: { checked: 0, total: 0 }
    };
    
    itemCategories.forEach((category, index) => {
        Object.keys(dimensionConfig).forEach(dim => {
            if (dimensionConfig[dim].includes(category)) {
                dimensionScores[dim].total += 1;
                if (checkedItems[index]) {
                    dimensionScores[dim].checked += 1;
                }
            }
        });
    });
    
    const trackingScore = dimensionScores.tracking.total 
        ? Math.round((dimensionScores.tracking.checked / dimensionScores.tracking.total) * 100) 
        : 0;
    const analysisScore = dimensionScores.analysis.total 
        ? Math.round((dimensionScores.analysis.checked / dimensionScores.analysis.total) * 100) 
        : 0;
    const evidenceScore = dimensionScores.evidence.total 
        ? Math.round((dimensionScores.evidence.checked / dimensionScores.evidence.total) * 100) 
        : 0;
    const solutionsScore = dimensionScores.solutions.total 
        ? Math.round((dimensionScores.solutions.checked / dimensionScores.solutions.total) * 100) 
        : 0;
    
    document.getElementById('scoreTracking').textContent = trackingScore + '%';
    document.getElementById('scoreAnalysis').textContent = analysisScore + '%';
    document.getElementById('scoreEvidence').textContent = evidenceScore + '%';
    document.getElementById('scoreSolutions').textContent = solutionsScore + '%';
}

/* ===========================
   EVIDENCE SUMMARY
=========================== */
function generateEvidenceSummary() {
    const checkedCount = checkedItems.filter(Boolean).length;
    const totalCount = checkedItems.length;
    const capacityScore = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;
    
    // Update summary score and status
    document.getElementById('summaryScore').textContent = capacityScore + '%';
    
    let statusText = 'Gathering Data';
    if (capacityScore >= 75) statusText = 'Strong Evidence';
    else if (capacityScore >= 40) statusText = 'Moderate Evidence';
    document.getElementById('summaryStatus').textContent = statusText;
    
    // Show the summary section
    document.getElementById('evidenceSummary').classList.add('active');
    
    // Scroll to summary
    document.getElementById('evidenceSummary').scrollIntoView({ behavior: 'smooth' });
    
    // Generate evidence facts based on checked items
    generateEvidenceFacts();
    
    // Generate conversation starters based on capacity score
    generateConversationStarters(capacityScore);
    
    // Generate capacity building strategies
    generateCapacityStrategies();
}

function generateEvidenceFacts() {
    const evidenceFactsGrid = document.getElementById('evidenceFactsGrid');
    evidenceFactsGrid.innerHTML = '';
    
    // Analyze which evidence points are available
    const evidenceFacts = [];
    
    // Time tracking evidence
    if (checkedItems[0]) { // "I've tracked my actual time..."
        evidenceFacts.push({
            title: 'Actual Time Data',
            description: 'You have concrete data on how you spend your time, which is the foundation for evidence-based conversations.',
            icon: 'fas fa-clock'
        });
    }
    
    // Hours evidence
    if (checkedItems[1]) {
        evidenceFacts.push({
            title: 'Real Hours Worked',
            description: 'You know your actual weekly hours, not just perceived workload. This helps identify overtime or unsustainable patterns.',
            icon: 'fas fa-business-time'
        });
    }
    
    // Meeting vs focus time evidence
    if (checkedItems[2]) {
        evidenceFacts.push({
            title: 'Meeting vs Focus Balance',
            description: 'You understand your meeting-to-focus ratio, a key factor in productivity and capacity management.',
            icon: 'fas fa-chart-pie'
        });
    }
    
    // Invisible work evidence
    if (checkedItems[3]) {
        evidenceFacts.push({
            title: 'Invisible Work Accounted',
            description: 'You\'ve quantified the "invisible" tasks that often get overlooked but consume significant time.',
            icon: 'fas fa-eye-slash'
        });
    }
    
    // Scope documentation evidence
    if (checkedItems[4]) {
        evidenceFacts.push({
            title: 'Documented Responsibilities',
            description: 'You have a written record of all current responsibilities with time estimates, creating clarity about scope.',
            icon: 'fas fa-list-check'
        });
    }
    
    // Role comparison evidence
    if (checkedItems[5]) {
        evidenceFacts.push({
            title: 'Role Alignment Analysis',
            description: 'You can compare actual workload to role expectations, highlighting potential misalignment.',
            icon: 'fas fa-balance-scale'
        });
    }
    
    // If we have multiple checked items but not enough for 3 facts
    const checkedCount = checkedItems.filter(item => item).length;
    if (checkedCount >= 3 && evidenceFacts.length === 0) {
        evidenceFacts.push({
            title: 'Multiple Data Points',
            description: 'You have collected multiple types of workload data, strengthening your evidence base.',
            icon: 'fas fa-database'
        });
    }
    
    // If no specific evidence facts (low score)
    if (evidenceFacts.length === 0) {
        evidenceFacts.push({
            title: 'Starting the Process',
            description: 'You\'re beginning to gather evidence about your workload. Focus on tracking time for one week.',
            icon: 'fas fa-flag'
        });
    }
    
    // Ensure we have at least 3 evidence facts
    while (evidenceFacts.length < 3) {
        if (evidenceFacts.length === 1) {
            evidenceFacts.push({
                title: 'Workload Patterns',
                description: 'Tracking reveals patterns in how work accumulates and when you\'re most productive.',
                icon: 'fas fa-chart-line'
            });
        } else {
            evidenceFacts.push({
                title: 'Capacity Insights',
                description: 'Evidence shows where time is well-spent versus where it might be wasted or misallocated.',
                icon: 'fas fa-lightbulb'
            });
        }
    }
    
    // Generate evidence fact cards (max 3)
    evidenceFacts.slice(0, 3).forEach((fact, index) => {
        const card = document.createElement('div');
        card.className = 'evidence-card';
        card.innerHTML = `
            <div class="evidence-icon">
                <i class="${fact.icon}"></i>
            </div>
            <h4 class="evidence-title-text">${fact.title}</h4>
            <p class="evidence-description">${fact.description}</p>
        `;
        evidenceFactsGrid.appendChild(card);
    });
}

function generateConversationStarters(capacityScore) {
    const conversationGrid = document.getElementById('conversationGrid');
    conversationGrid.innerHTML = '';
    
    let starters = [];
    
    if (capacityScore >= 75) {
        starters = [
            {
                title: 'Data-Driven Prioritization',
                description: '"Based on my time tracking, I\'m spending X hours on Y. Let\'s discuss if this aligns with our priorities."',
                icon: 'fas fa-chart-bar'
            },
            {
                title: 'Sustainable Workload',
                description: '"My data shows I\'m working X hours weekly. Can we discuss ensuring this remains sustainable long-term?"',
                icon: 'fas fa-heartbeat'
            },
            {
                title: 'Growth vs Maintenance',
                description: '"Only Y% of my time is on growth work. How can we increase this to support my development and team goals?"',
                icon: 'fas fa-seedling'
            }
        ];
    } else if (capacityScore >= 40) {
        starters = [
            {
                title: 'Initial Workload Review',
                description: '"I\'ve started tracking my time and notice some patterns. Can we review my current responsibilities?"',
                icon: 'fas fa-clipboard-check'
            },
            {
                title: 'Meeting Time Impact',
                description: '"Meetings are taking up X% of my week. Can we discuss which are essential for my role?"',
                icon: 'fas fa-users'
            },
            {
                title: 'Scope Clarification',
                description: '"I want to ensure I\'m focused on the right things. Can we align on my top 3 priorities for this quarter?"',
                icon: 'fas fa-bullseye'
            }
        ];
    } else {
        starters = [
            {
                title: 'Starting the Conversation',
                description: '"I want to better understand my capacity. Can we discuss my current workload and priorities?"',
                icon: 'fas fa-comment'
            },
            {
                title: 'Workload Assessment',
                description: '"I feel at capacity. Can we review what\'s on my plate and identify what might be deprioritised?"',
                icon: 'fas fa-tasks'
            },
            {
                title: 'Time Tracking Plan',
                description: '"I plan to track my time for a week to get clearer data. Can we then discuss what the data shows?"',
                icon: 'fas fa-calendar-plus'
            }
        ];
    }
    
    // Generate conversation starter cards WITHOUT numbers
    starters.forEach((starter, index) => {
        const card = document.createElement('div');
        card.className = 'conversation-card';
        card.innerHTML = `
            <div class="conversation-icon">
                <i class="${starter.icon}"></i>
            </div>
            <h4 class="conversation-title">${starter.title}</h4>
            <p class="conversation-description">${starter.description}</p>
        `;
        conversationGrid.appendChild(card);
    });
}

function generateCapacityStrategies() {
    const boundaryGrid = document.getElementById('boundaryGrid');
    boundaryGrid.innerHTML = '';
    
    // Analyze which areas need strategies
    const uncheckedCategories = {};
    
    checkedItems.forEach((checked, index) => {
        if (!checked) {
            const category = itemCategories[index];
            uncheckedCategories[category] = (uncheckedCategories[category] || 0) + 1;
        }
    });
    
    // Determine strategies based on weak areas
    let strategies = [];
    
    // Always include time tracking strategy
    strategies.push({
        title: 'One-Week Time Audit',
        description: 'Use a simple spreadsheet or time tracking app to log all work for 7 days. Categorise by project, meeting type, and task type.',
        icon: 'fas fa-stopwatch'
    });
    
    // Meeting optimization if needed
    if (uncheckedCategories['meetings']) {
        strategies.push({
            title: 'Meeting Effectiveness Review',
            description: 'Evaluate which meetings are essential, which could be emails, and which you could attend less frequently.',
            icon: 'fas fa-user-clock'
        });
    } else {
        strategies.push({
            title: 'Protected Focus Time',
            description: 'Block 2-3 hours daily for deep work. Treat this time as non-negotiable for priority projects.',
            icon: 'fas fa-lock'
        });
    }
    
    // Delegation strategy if needed
    if (uncheckedCategories['options']) {
        strategies.push({
            title: 'Delegation Opportunities',
            description: 'Identify tasks that could be delegated to junior team members or automated with tools.',
            icon: 'fas fa-people-arrows'
        });
    } else {
        strategies.push({
            title: 'Quarterly Workload Review',
            description: 'Schedule a quarterly review of all responsibilities with your manager to ensure alignment.',
            icon: 'fas fa-calendar-alt'
        });
    }
    
    // If we still need more strategies, add defaults
    if (strategies.length < 3) {
        strategies.push({
            title: 'Email & Communication Boundaries',
            description: 'Set specific times for checking email and messaging apps to reduce context switching.',
            icon: 'fas fa-envelope'
        });
    }
    
    // Generate strategy cards
    strategies.slice(0, 3).forEach(strategy => {
        const card = document.createElement('div');
        card.className = 'boundary-card';
        card.innerHTML = `
            <div class="boundary-icon">
                <i class="${strategy.icon}"></i>
            </div>
            <h4 class="boundary-title">${strategy.title}</h4>
            <p class="boundary-description">${strategy.description}</p>
            <a href="#" class="boundary-link" onclick="return false;">
                Learn More <i class="fas fa-arrow-right"></i>
            </a>
        `;
        boundaryGrid.appendChild(card);
    });
}

/* ===========================
   COPY CHECKLIST
=========================== */
function copyChecklist() {
    // Get all text content
    const checklistName = 'CAPACITY REALITY CHECK';
    const mainHeading = document.querySelector('.hero-main-heading').textContent;
    const checklistItems = document.querySelectorAll('.checklist-text');
    
    let text = `${checklistName}\n`;
    text += `=============================\n\n`;
    text += `${mainHeading}\n\n`;
    
    text += `CAPACITY CHECKLIST:\n`;
    text += `===================\n\n`;
    
    checklistItems.forEach((item, index) => {
        const isChecked = checkedItems[index] ? '[✓]' : '[ ]';
        text += `${isChecked} ${index + 1}. ${item.innerText}\n`;
    });
    
    // Add current stats if available
    const checkedCount = checkedItems.filter(Boolean).length;
    if (checkedCount > 0) {
        const capacityScore = Math.round((checkedCount / checklistItems.length) * 100);
        let status = 'Gathering Data';
        if (capacityScore >= 75) status = 'Strong Evidence';
        else if (capacityScore >= 40) status = 'Moderate Evidence';
        
        text += `\nCURRENT STATUS:\n`;
        text += `===============\n`;
        text += `Items checked: ${checkedCount}/${checklistItems.length}\n`;
        text += `Capacity Evidence Score: ${capacityScore}%\n`;
        text += `Status: ${status}\n`;
    }
    
    navigator.clipboard.writeText(text);
    
    // Show visual feedback
    const btn = document.getElementById('copyBtn');
    const originalHTML = btn.innerHTML;
    const originalBg = btn.style.background;
    
    btn.innerHTML = '<i class="fas fa-check"></i> Checklist Copied!';
    btn.style.background = '#10b981';
    
    setTimeout(() => {
        btn.innerHTML = originalHTML;
        btn.style.background = originalBg;
    }, 2000);
}

/* ===========================
   MY PLAYBOOK (LOCALSTORAGE)
=========================== */
const PLAYBOOK_KEY = 'tepSavedItems';
const CURRENT_TOOL_ID = 'capacity-reality-check';
const CURRENT_TOOL_TITLE = 'Capacity Reality Check';
const CURRENT_TOOL_TYPE = 'Tool';

function getSavedItems() {
    try {
        const raw = localStorage.getItem(PLAYBOOK_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
    } catch (e) {
        console.warn('Error reading saved items:', e);
        return [];
    }
}

function setSavedItems(items) {
    try {
        localStorage.setItem(PLAYBOOK_KEY, JSON.stringify(items));
    } catch (e) {
        console.warn('Error saving items:', e);
    }
}

function initializePlaybook() {
    const playbookOverlay = document.getElementById('playbookOverlay');
    const playbookSidebar = document.getElementById('playbookSidebar');
    const playbookButton = document.getElementById('myPlaybookButton');
    const closeBtn = document.getElementById('closePlaybook');
    const saveItemBtn = document.getElementById('saveBtn');

    if (!playbookOverlay || !playbookSidebar || !playbookButton || !closeBtn || !saveItemBtn) return;

    renderSavedItems();

    const savedItems = getSavedItems();
    const isAlreadySaved = savedItems.some(item => item.id === CURRENT_TOOL_ID);
    updateSaveButtonState(saveItemBtn, isAlreadySaved);

    saveItemBtn.addEventListener('click', () => {
        const items = getSavedItems();
        const index = items.findIndex(item => item.id === CURRENT_TOOL_ID);
        let nowSaved;

        if (index === -1) {
            const toolLink = window.location.pathname.split('/').pop() || 'capacity-reality-check.html';
            items.push({
                id: CURRENT_TOOL_ID,
                title: CURRENT_TOOL_TITLE,
                type: CURRENT_TOOL_TYPE,
                link: toolLink,
                savedAt: new Date().toISOString()
            });
            nowSaved = true;
        } else {
            items.splice(index, 1);
            nowSaved = false;
        }

        setSavedItems(items);
        updateSaveButtonState(saveItemBtn, nowSaved);
        renderSavedItems();
    });

    playbookButton.addEventListener('click', () => {
        playbookOverlay.classList.add('open');
        playbookSidebar.classList.add('open');
    });

    closeBtn.addEventListener('click', () => {
        playbookOverlay.classList.remove('open');
        playbookSidebar.classList.remove('open');
    });

    playbookOverlay.addEventListener('click', (e) => {
        if (e.target === playbookOverlay) {
            playbookOverlay.classList.remove('open');
            playbookSidebar.classList.remove('open');
        }
    });
}

function updateSaveButtonState(button, isSaved) {
    if (!button) return;
    const icon = button.querySelector('i');
    const label = button.querySelector('span');

    if (isSaved) {
        button.classList.add('saved');
        if (icon) {
            icon.classList.remove('far');
            icon.classList.add('fas');
        }
        if (label) label.textContent = 'Saved';
    } else {
        button.classList.remove('saved');
        if (icon) {
            icon.classList.remove('fas');
            icon.classList.add('far');
        }
        if (label) label.textContent = 'Save item';
    }
}

function renderSavedItems() {
    const listEl = document.getElementById('savedItemsList');
    const emptyEl = document.getElementById('savedItemsEmpty');
    if (!listEl || !emptyEl) return;

    const items = getSavedItems();
    listEl.innerHTML = '';

    if (!items.length) {
        emptyEl.style.display = 'block';
        return;
    }

    emptyEl.style.display = 'none';

    items.forEach(item => {
        const li = document.createElement('li');
        li.className = 'saved-item';
        const savedDate = item.savedAt ? new Date(item.savedAt) : null;
        const dateText = savedDate
            ? savedDate.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })
            : '';

        li.innerHTML = `
            <div class="saved-item-title-row">
                <span class="saved-item-title">${item.title}</span>
                <span class="saved-item-type">${item.type}</span>
            </div>
            <div class="saved-item-meta">
                ${dateText ? `Saved on ${dateText}` : ''}
            </div>
            <a class="saved-item-link" href="${item.link}">
                Open <i class="fas fa-arrow-right"></i>
            </a>
        `;
        listEl.appendChild(li);
    });
}

console.log('Capacity Reality Check script loaded');
</script>
</body>
</html>
